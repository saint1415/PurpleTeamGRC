# Purple Team Portable - Auditor Guide

## Overview

This platform provides automated security assessments with compliance mapping to major regulatory frameworks. All findings are automatically mapped to compliance controls with formal requirement citations.

## For Auditors

### Available Data Formats

| Format | Location | Use Case |
|--------|----------|----------|
| HTML Reports | `data/reports/*.html` | Human-readable, printable |
| JSON Raw Data | `data/reports/*.json` | API integration, analysis |
| CSV Exports | `data/reports/*.csv` | Excel, GRC platform import |
| Evidence DB | `data/evidence/evidence.db` | SQLite, full audit trail |
| Session Logs | `data/results/SESSION-*/` | Raw scan outputs |
| Execution Logs | `data/logs/` | Audit trail of operations |

### Compliance Frameworks Mapped

1. **NIST 800-53 Rev. 5** - Federal information security controls
2. **HIPAA Security Rule** - Healthcare data protection (45 CFR 164.3xx)
3. **SOC 1 Type II** - Financial reporting controls (SSAE 18)
4. **SOC 2 Type II** - Trust services criteria (Security, Availability, etc.)
5. **PCI-DSS v4.0** - Payment card industry requirements
6. **ISO/IEC 27001:2022** - Information security management
7. **CMMC** - Cybersecurity maturity model
8. **FedRAMP** - Federal cloud requirements
9. **GDPR** - EU data protection
10. **SOX** - Financial controls

### Evidence Package Contents

Each assessment generates:

```
SESSION-YYYYMMDDHHMMSS/
├── scan.log              # Detailed execution log
├── network_YYYYMMDD.json # Network scan results
├── vulnerability_*.json  # Vulnerability findings
├── compliance_*.json     # Control assessment
└── raw/                  # Raw tool outputs
```

### Requirement Citations

All controls include formal requirement citations:

**Example: NIST 800-53**
```
Control: RA-5
Citation: NIST SP 800-53 Rev. 5, RA-5: Vulnerability Monitoring and Scanning
```

**Example: HIPAA**
```
Control: 164.312(e)(1)
Citation: HIPAA Security Rule 45 CFR § 164.312(e)(1): Transmission Security
```

**Example: PCI-DSS**
```
Control: 11.3
Citation: PCI DSS v4.0, Requirement 11.3: Vulnerabilities Identified/Prioritized/Addressed
```

### Importing to GRC Platforms

**ServiceNow GRC / RSA Archer / OneTrust:**
1. Use CSV files in `data/reports/`
2. Map columns: Framework, Control ID, Status, Evidence Count

**Drata / Vanta:**
1. Use JSON exports
2. API-compatible format included

**OSCAL (Federal/NIST):**
1. OSCAL JSON available via exporter utility
2. Complies with OSCAL 1.1.2 schema

### Retention Policy

- **365 days** - All evidence, logs, and results retained
- **Compression** - Files older than 30 days are compressed
- **Integrity** - SHA-256 hashes for all evidence files

### Generating Reports

```bash
# Generate comprehensive audit report with citations
python3 utilities/audit_report.py

# Export for specific framework
python3 utilities/exporter.py NIST-800-53 --format all

# Create evidence package
python3 utilities/exporter.py PCI-DSS-v4 --format package
```

### Database Schema

The evidence database (`data/evidence/evidence.db`) contains:

- `evidence` - All collected evidence artifacts
- `control_mappings` - Finding-to-control mappings
- `findings` - Security findings with severity
- `sessions` - Assessment session metadata
- `attestations` - Control attestation records

### Contact

For questions about assessment methodology or evidence interpretation, refer to the scan session logs which contain detailed execution steps and tool configurations.

---

Generated by Purple Team Portable v4.0
