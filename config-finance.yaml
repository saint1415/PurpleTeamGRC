# Purple Team GRC Platform Configuration
# Version: 3.0
# Industry: FINANCIAL SERVICES
# Compliance: SOX, PCI-DSS, GLBA, FFIEC, SOC 2
# Auto-generated: 2026-01-01

# ============================================================================
# CLIENT INFORMATION
# ============================================================================
client:
  name: "Financial Services Client Name"
  industry: "finance"
  engagement_type: "sox_audit"  # sox_audit, pci_assessment, security_assessment
  engagement_date: "2026-01-01"
  consultant: "Consultant Name"
  contact_email: "compliance@financialclient.com"
  
  # Finance-specific information
  finance:
    entity_type: "publicly_traded"  # publicly_traded, private, credit_union, bank
    sox_scope: true  # Subject to Sarbanes-Oxley Act
    pci_scope: true  # Processes credit card payments
    pci_level: "Level 1"  # Level 1, 2, 3, or 4
    transaction_volume: 0  # Annual transaction volume
    regulated_systems: []  # List of ITGC-scoped systems

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================
network:
  auto_detect: true
  ranges: []
  exclusions: []
    # Common financial exclusions:
    # - "10.x.x.x"  # Core banking systems (schedule separately)
    # - "10.x.x.x"  # Payment processing (PCI cardholder data environment)
    # - "10.x.x.x"  # Trading platforms (schedule during market close)
  
  dns_servers:
    - "8.8.8.8"
    - "1.1.1.1"
  
  prefer_wired: true
  scan_all_interfaces: true
  
  # Finance-specific network considerations
  finance_network:
    pci_cde_network: false  # PCI Cardholder Data Environment present?
    trading_network: false  # Trading/market data network present?
    dmz_configuration: true  # DMZ for public-facing services?
    network_segmentation: true  # Segmentation between environments?

# ============================================================================
# COMPLIANCE FRAMEWORKS (FINANCE-SPECIFIC)
# ============================================================================
compliance:
  frameworks:
    - "SOX"           # Sarbanes-Oxley Act
    - "PCI-DSS"       # Payment Card Industry Data Security Standard
    - "GLBA"          # Gramm-Leach-Bliley Act
    - "FFIEC"         # Federal Financial Institutions Examination Council
    - "SOC2"          # SOC 2 Type II
    - "NIST"          # NIST Cybersecurity Framework
    - "ISO27001"      # ISO/IEC 27001
  
  # SOX-specific controls (IT General Controls)
  sox:
    itgc_controls:
      access_controls: true          # ITGC-01: Logical access controls
      change_management: true         # ITGC-02: Program change controls
      computer_operations: true       # ITGC-03: Computer operations
      segregation_of_duties: true     # ITGC-04: Segregation of duties
    
    financial_reporting_systems:
      erp_in_scope: true
      gl_in_scope: true
      sub_ledgers_in_scope: true
  
  # PCI-DSS specific controls
  pci_dss:
    version: "4.0"  # PCI-DSS version (3.2.1 or 4.0)
    
    requirements:
      req_1_firewall: true              # Install and maintain network security controls
      req_2_defaults: true              # Apply secure configurations
      req_3_protect_data: true          # Protect stored cardholder data
      req_4_encrypt_transmission: true  # Protect cardholder data in transit
      req_5_malware: true               # Protect systems from malicious software
      req_6_secure_systems: true        # Develop and maintain secure systems
      req_7_access_controls: true       # Restrict access by business need
      req_8_identify_users: true        # Identify users and authenticate access
      req_9_physical_access: true       # Restrict physical access
      req_10_log_access: true           # Log and monitor all access
      req_11_test_security: true        # Test security of systems regularly
      req_12_security_policy: true      # Support information security
    
    cardholder_data_environment:
      in_scope: true
      segmentation_implemented: true
      compensating_controls: []
  
  # Evidence collection (enhanced for financial audits)
  evidence:
    collect_screenshots: true
    collect_logs: true
    collect_configs: true
    retention_days: 2555  # 7 years (SOX requirement)
    
    # Finance-specific evidence
    financial_controls:
      itgc_evidence: true           # Collect ITGC evidence
      change_tickets: true          # Collect change management evidence
      access_reviews: true          # Collect access review evidence
      encrypt_evidence: true        # Encrypt all collected evidence
    
    # Map evidence to SOX/PCI controls
    control_mapping:
      automatic: true
      sox_mapping: true
      pci_mapping: true
      include_citations: true

# ============================================================================
# SCANNING CONFIGURATION (FINANCE-OPTIMIZED)
# ============================================================================
scanning:
  # Conservative scanning for financial environments
  stealth_level: 2  # Higher stealth
  max_rate: 75      # Moderate rate
  
  random_delay_min: 60
  random_delay_max: 300
  
  timing_template: "T2"
  max_threads: 8
  
  port_profiles:
    quick: "22,80,443,3389,8080"
    common: "20,21,22,23,25,53,80,110,135,139,143,443,445,993,995,1433,3306,3389,5432,5900,8080,8443"
    finance_specific: "22,80,443,1433,3306,5432,8080,8443,9042,27017"  # DB and web services
    pci_scan: "22,80,443,3389,8080,8443"  # PCI-required ports
    top100: "--top-ports 100"
    top1000: "--top-ports 1000"
    all: "-p-"
  
  default_ports: "finance_specific"
  
  version_detection: true
  os_detection: true  # Required for PCI compliance
  
  # Finance-specific scanning rules
  finance_scanning:
    pci_quarterly_scan: true         # Quarterly PCI ASV scans required
    sox_annual_scan: true            # Annual SOX IT audit
    
    # Trading hours consideration
    avoid_trading_hours: true
    trading_hours:
      start: "09:30"
      end: "16:00"
      timezone: "America/New_York"
    
    # Change freeze periods
    respect_freeze_periods: true
    freeze_periods:
      quarter_end: true              # Avoid quarter-end close
      year_end: true                 # Avoid year-end close

# ============================================================================
# SCHEDULING (FINANCIAL COMPLIANCE CYCLES)
# ============================================================================
schedule:
  # All scans during non-trading hours
  vulnerability_scan:
    enabled: true
    day: "Saturday"    # Weekend only
    time: "22:00"      # After trading hours
    notify: true
  
  network_scan:
    enabled: true
    day: "Sunday"
    time: "02:00"
    notify: true
  
  compliance_check:
    enabled: true
    day: "Friday"
    time: "18:00"      # After market close
    notify: true
  
  health_check:
    enabled: true
    frequency: "daily"
    time: "06:00"
    notify_on_failure: true
  
  # Finance-specific scheduled tasks
  finance_tasks:
    pci_quarterly_scan:
      enabled: true
      frequency: "quarterly"
      next_due: "2026-03-31"
    
    sox_annual_assessment:
      enabled: true
      frequency: "annual"
      next_due: "2026-12-31"
    
    itgc_testing:
      enabled: true
      frequency: "annual"
      next_due: "2026-12-31"

# ============================================================================
# RESULTS & REPORTING (SOX/PCI COMPLIANT)
# ============================================================================
results:
  output_dir: "~/.purple-team/results/"
  retention_days: 2555  # 7 years (SOX requirement)
  auto_archive: true
  archive_location: "~/.purple-team/results/archived/"
  
  formats:
    - "json"
    - "html"
    - "csv"
    - "pdf"
  
  branding:
    company_name: "Your Financial Security Consulting Firm"
    logo_path: ""
    footer_text: "Confidential - Financial Information"
  
  executive_reports:
    include_charts: true
    include_recommendations: true
    risk_matrix: true
    
    # Finance-specific reporting
    finance_reporting:
      sox_control_mapping: true
      pci_requirement_mapping: true
      itgc_coverage: true
      gap_analysis: true
      remediation_timeline: true
      cite_regulations: true

# ============================================================================
# DASHBOARD
# ============================================================================
dashboard:
  host: "127.0.0.1"
  port: 5000
  debug: false
  auth_enabled: true
  username: "admin"
  password_hash: ""
  session_timeout: 20  # 20 minute timeout

# ============================================================================
# LOGGING (SOX AUDIT TRAIL)
# ============================================================================
logging:
  level: "INFO"
  max_size_mb: 100
  backup_count: 50  # More backup logs for SOX compliance
  
  user_logs: "~/.purple-team/logs/"
  system_logs: "/var/log/purple-team/{username}/"
  
  rotate_daily: true
  
  # SOX audit trail requirements
  sox_audit_trail:
    enabled: true
    log_all_access: true
    log_all_changes: true
    log_privileged_access: true
    tamper_detection: true
    retention_days: 2555  # 7 years

# ============================================================================
# EMAIL NOTIFICATIONS
# ============================================================================
email:
  enabled: false
  smtp_server: "smtp.gmail.com"
  smtp_port: 587
  use_tls: true
  username: ""
  password: ""
  from_address: ""
  to_addresses: []
  subject_prefix: "[SOX/PCI Audit]"
  include_summary: true
  include_full_report: false
  encrypt_attachments: true

# ============================================================================
# EXPLOIT VALIDATION (RESTRICTED FOR FINANCE)
# ============================================================================
exploit_validation:
  enabled: false  # Typically disabled in production financial environments
  test_credentials: []

# ============================================================================
# INTEGRATION SETTINGS
# ============================================================================
integrations:
  thehive:
    enabled: false
    url: "http://localhost:9000"
    api_key: ""
    organization: "finance"
    auto_create_cases: true
  
  wazuh:
    enabled: false
    url: "http://localhost:55000"
    username: ""
    password: ""
    auto_import_alerts: true
  
  suricata:
    enabled: false
    eve_log_path: "/var/log/suricata/eve.json"
    import_alerts: true

# ============================================================================
# ADVANCED SETTINGS
# ============================================================================
advanced:
  python_stable: "3.11"
  python_latest: "3.12"
  prefer_stable: true
  
  venv_system: "/opt/purple-team/venv"
  venv_user: "~/.purple-team/venv"
  
  auto_update_check: true
  auto_install_updates: false
  check_breaking_changes: true
  
  max_concurrent_scans: 3
  scan_timeout_minutes: 180
  
  auto_backup: true
  backup_location: "/opt/purple-team-backups/"
  backup_retention_days: 90

# ============================================================================
# SOX CONTROL MAPPING (IT General Controls)
# ============================================================================
sox_itgc_mapping:
  access_controls:
    logical_access:
      - "User provisioning: (manual process - verify with compliance_checker.py)"
      - "User termination: (manual process - verify with compliance_checker.py)"
      - "Periodic access reviews: asset_inventory_tracker.py"
      - "Password policies: compliance_checker.py"
      - "Privileged access: (manual process - verify with compliance_checker.py)"
    
  change_management:
    program_changes:
      - "Change request/approval: (manual process - verify with evidence_manager.py)"
      - "Testing procedures: (manual process)"
      - "Migration controls: (manual process)"
      - "Emergency changes: (manual process)"
  
  computer_operations:
    monitoring:
      - "System monitoring: health_check_monitor.py"
      - "Log monitoring: All scripts log activity"
      - "Incident response: evidence_manager.py + TheHive"
    
    backup_recovery:
      - "Backup procedures: backup_restore.py"
      - "Recovery testing: (manual process - track with compliance_checker.py)"

# ============================================================================
# PCI-DSS CONTROL MAPPING
# ============================================================================
pci_dss_mapping:
  requirement_1:
    - "Firewall configuration: network_scanner.py (verify firewall rules)"
  
  requirement_2:
    - "Default passwords: vulnerability_scanner.py (check for defaults)"
    - "Secure configurations: compliance_checker.py"
  
  requirement_6:
    - "Vulnerability scanning: vulnerability_scanner.py (quarterly)"
    - "Patch management: patch_status_checker.py"
  
  requirement_10:
    - "Audit logging: All platform scripts"
    - "Log review: health_check_monitor.py"
  
  requirement_11:
    - "Quarterly ASV scans: vulnerability_scanner.py (scheduled)"
    - "Internal scans: network_scanner.py"
    - "Penetration testing: (manual - annual requirement)"

# ============================================================================
# END OF FINANCE CONFIGURATION
# ============================================================================
