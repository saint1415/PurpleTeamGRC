<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Purple Team GRC Platform v3.0 - Complete Deployment Guide</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* ==================================================
           DARK THEME ONLY - NO VARIABLES, ABSOLUTE COLORS
           ================================================== */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            background: #1a1d23;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #e9ecef;
            background: #1a1d23;
            display: flex;
            min-height: 100vh;
        }

        /* ==================================================
           SIDEBAR
           ================================================== */
        
        .sidebar {
            width: 260px;
            background: #22252b;
            border-right: 1px solid #3a3d45;
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            overflow-y: auto;
            padding: 20px 0;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid #3a3d45;
            margin-bottom: 20px;
        }

        .sidebar-header h2 {
            font-size: 1.3rem;
            color: #ffffff;
            font-weight: 600;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            padding: 8px 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #adb5bd;
        }

        .sidebar nav ul {
            list-style: none;
        }

        .sidebar nav li {
            margin: 0;
        }

        .sidebar nav a {
            display: block;
            padding: 8px 20px;
            color: #adb5bd;
            text-decoration: none;
            font-size: 0.9rem;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }

        .sidebar nav a:hover {
            background: #2a2d35;
            color: #ffffff;
            border-left-color: #0066cc;
        }

        /* ==================================================
           MAIN CONTENT
           ================================================== */
        
        .main-content {
            margin-left: 260px;
            flex: 1;
            padding: 30px 40px;
            background: #1a1d23;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        /* ==================================================
           HEADER
           ================================================== */
        
        header {
            background: #2a2d35;
            color: #ffffff;
            padding: 36px 24px;
            border-radius: 4px;
            margin-bottom: 20px;
            border: 1px solid #3a3d45;
        }

        header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            letter-spacing: -0.03em;
            margin-bottom: 6px;
            color: #ffffff;
        }

        header .subtitle {
            font-size: 1.1rem;
            font-weight: 500;
            color: #e9ecef;
            margin-bottom: 8px;
        }

        header .meta {
            margin-top: 8px;
            font-size: 0.95rem;
            color: #adb5bd;
        }

        /* ==================================================
           SECTIONS & CARDS
           ================================================== */
        
        section {
            background: #2a2d35;
            border-radius: 4px;
            border: 1px solid #3a3d45;
            padding: 22px 20px 24px;
            margin-bottom: 22px;
        }

        /* ==================================================
           TYPOGRAPHY
           ================================================== */
        
        h1, h2, h3, h4, h5, h6 {
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 14px;
            line-height: 1.3;
        }

        h1 { font-size: 2.2rem; }
        h2 { font-size: 1.8rem; border-bottom: 2px solid #3a3d45; padding-bottom: 8px; }
        h3 { font-size: 1.4rem; margin-top: 24px; }
        h4 { font-size: 1.1rem; }

        p {
            margin-bottom: 14px;
            color: #e9ecef;
        }

        a {
            color: #66b3ff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        strong {
            font-weight: 600;
            color: #ffffff;
        }

        em {
            font-style: italic;
            color: #e9ecef;
        }

        /* ==================================================
           LISTS
           ================================================== */
        
        ul, ol {
            margin: 14px 0 14px 24px;
            color: #e9ecef;
        }

        li {
            margin-bottom: 8px;
            color: #e9ecef;
        }

        /* ==================================================
           CODE BLOCKS
           ================================================== */
        
        pre {
            background: #1e2127;
            border: 1px solid #3a3d45;
            border-radius: 4px;
            padding: 14px;
            overflow-x: auto;
            margin: 14px 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            color: #e9ecef;
        }

        pre code {
            color: #e9ecef;
        }

        /* Inline code */
        p code, li code, td code {
            background: #2a2d35;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
            color: #66b3ff;
        }

        .mono {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background: #2a2d35;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
            color: #66b3ff;
        }

        /* ==================================================
           TABLES
           ================================================== */
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            background: #2a2d35;
        }

        th {
            background: #1e2127;
            color: #ffffff;
            font-weight: 600;
            text-align: left;
            padding: 12px;
            border: 1px solid #3a3d45;
        }

        td {
            padding: 10px 12px;
            border: 1px solid #3a3d45;
            color: #e9ecef;
        }

        tr:nth-child(even) td {
            background: #252830;
        }

        /* ==================================================
           CALLOUT BOXES
           ================================================== */
        
        .callout {
            border-left: 4px solid #f0ad4e;
            background: rgba(240, 173, 78, 0.1);
            padding: 14px 16px;
            margin: 14px 0;
            border-radius: 0 4px 4px 0;
        }

        .callout * {
            color: #e9ecef;
        }

        .callout strong {
            color: #ffffff;
        }

        .callout-title {
            font-weight: 600;
            font-size: 1.05rem;
            margin-bottom: 8px;
            color: #ffffff;
        }

        .callout.critical {
            border-left-color: #d9534f;
            background: rgba(217, 83, 79, 0.1);
        }

        .callout.warning {
            border-left-color: #f0ad4e;
            background: rgba(240, 173, 78, 0.1);
        }

        .callout.info {
            border-left-color: #66b3ff;
            background: rgba(102, 179, 255, 0.1);
        }

        .callout.success {
            border-left-color: #5cb85c;
            background: rgba(92, 184, 92, 0.1);
        }

        /* ==================================================
           STEP BOXES (Numbered Instructions)
           ================================================== */
        
        .step-box {
            background: #2a2d35;
            border: 1px solid #3a3d45;
            border-left: 4px solid #0066cc;
            padding: 20px 20px 20px 70px;
            margin: 16px 0;
            position: relative;
            border-radius: 4px;
        }

        .step-box::before {
            content: attr(data-number);
            position: absolute;
            left: 20px;
            top: 20px;
            width: 32px;
            height: 32px;
            background: #0066cc;
            color: #ffffff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
        }

        .step-box h4 {
            color: #ffffff;
            margin-bottom: 8px;
        }

        .step-box p,
        .step-box ul,
        .step-box li {
            color: #e9ecef;
        }

        /* ==================================================
           SVG DIAGRAMS
           ================================================== */
        
        svg {
            max-width: 100%;
            height: auto;
        }

        .svg-text {
            fill: #e9ecef;
            font-family: 'Consolas', monospace;
            font-size: 14px;
        }

        .svg-box {
            fill: none;
            stroke: #66b3ff;
            stroke-width: 2;
        }

        .svg-line {
            stroke: #6c757d;
            stroke-width: 2;
        }

        /* ==================================================
           PRINT STYLES
           ================================================== */
        
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .sidebar {
                display: none;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            section {
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }
        }

        /* ==================================================
           RESPONSIVE
           ================================================== */
        
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
            }
            
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
        }
    </style></style>
</head>
<body>

<div class="app-layout">
    <aside class="sidebar">
        <div class="sidebar-header">Purple Team GRC</div>

        <div class="nav-section">
            <div class="nav-section-title">Core Sections</div>
            <ul class="nav-links">
                <li><a href="#introduction-overview">1. Introduction</a></li>
                <li><a href="#prerequisites-planning">2. Prerequisites</a></li>
                <li><a href="#phase1-kali-install">3. Phase 1 – Kali Install</a></li>
                <li><a href="#phase2-platform-install">4. Phase 2 – Platform Install</a></li>
                <li><a href="#phase3-validation-testing">5. Phase 3 – Validation</a></li>
                <li><a href="#phase4-production">6. Phase 4 – Production</a></li>
                <li><a href="#troubleshooting-main">7. Troubleshooting</a></li>
            </ul>
        </div>

        <div class="nav-section">
            <div class="nav-section-title">Appendices</div>
            <ul class="nav-links">
                <li><a href="#appendix-a-master-setup">Appendix A – master_setup.sh</a></li>
                <li><a href="#appendix-b-python-scripts">Appendix B – Python Scripts</a></li>
                <li><a href="#appendix-c-config-templates">Appendix C – Config Templates</a></li>
                <li><a href="#appendix-d-decision-trees">Appendix D – Decision Trees</a></li>
                <li><a href="#appendix-e-network-diagrams">Appendix E – Network Diagrams</a></li>
                <li><a href="#appendix-f-compliance">Appendix F – Compliance Mapping</a></li>
                <li><a href="#appendix-g-commands">Appendix G – Command Reference</a></li>
                <li><a href="#appendix-h-recovery">Appendix H – Recovery</a></li>
            </ul>
        </div>

        
    </aside>

    <main class="main-content">
        <!-- BEGIN: Full original guide content from Purple_Team_Deployment_Guide_v3 - Copy.html -->
        <div class="container">

            <header>
                <h1>Purple Team GRC Platform v3.0 – Complete Deployment Guide</h1>
                <p class="subtitle">From Bare-Metal Kali Purple Install to Production-Ready GRC Operations</p>
                <p class="meta">
                    Enterprise-Grade Security &amp; Compliance Platform • Built on Kali Purple<br>
                    This guide is fully standalone. You do not need any other documents to deploy.
                </p>
            </header>

            <!-- GOLDEN RULES – MUST APPEAR IMMEDIATELY AFTER TITLE -->
            <div class="callout golden-rules critical">
                <div class="callout-title">GOLDEN RULES – READ BEFORE YOU DO ANYTHING</div>
                <ul>
                    <li><strong>Golden Rule #1 – Only scan systems you are authorized to test.</strong>
                        Unauthorized scanning can be illegal. Always have written permission from the client or owner.</li>
                    <li><strong>Golden Rule #2 – Never run this platform as <span class="mono">root</span> for daily use.</strong>
                        You will use <span class="mono">sudo</span> (administrator) <em>only</em> for installation and a few maintenance commands.</li>
                    <li><strong>Golden Rule #3 – Protect client data and evidence.</strong>
                        Scan results and evidence may contain sensitive information. Treat <span class="mono">/opt/purple-team</span> and <span class="mono">~/.purple-team</span> as confidential.</li>
                    <li><strong>Golden Rule #4 – Do not scan production-critical systems during peak hours.</strong>
                        Always coordinate maintenance windows with the client.</li>
                    <li><strong>Golden Rule #5 – If something looks wrong, stop and verify before continuing.</strong>
                        This guide provides decision trees and recovery procedures. Use them rather than guessing.</li>
                </ul>
            </div>

            <div class="doc-info">
                <table>
                    <tr>
                        <td>Document Version</td>
                        <td>3.0 <span class="version-badge">Current Release</span></td>
                    </tr>
                    <tr>
                        <td>Platform Version</td>
                        <td>Purple Team GRC Platform v3.0</td>
                    </tr>
                    <tr>
                        <td>Production Readiness</td>
                        <td><span class="readiness-badge">100 / 100</span> Enterprise-Grade</td>
                    </tr>
                    <tr>
                        <td>Target Operating System</td>
                        <td>Kali Purple 2024.4+ (not standard Kali Linux)</td>
                    </tr>
                    <tr>
                        <td>Intended Audience</td>
                        <td>Security consultants, internal audit teams, and engineers with <strong>no prior Linux experience required</strong></td>
                    </tr>
                    <tr>
                        <td>Estimated Total Time</td>
                        <td>2–3 hours initial build + 1 hour first client configuration</td>
                    </tr>
                    <tr>
                        <td>Key Features in v3.0</td>
                        <td>Dual Installation (system + user) • Network Auto-Detection • Industry Templates • Terminal &amp; GUI Launchers • Comprehensive GRC Automation</td>
                    </tr>
                    <tr>
                        <td>Last Updated</td>
                        <td>January 2026</td>
                    </tr>
                </table>
            </div>

            <div class="toc" id="table-of-contents">
                <h2>Table of Contents</h2>
                <ul>
                    <li><a href="#introduction-overview">1. Introduction &amp; Overview</a></li>
                    <li><a href="#prerequisites-planning">2. Prerequisites &amp; Planning</a></li>
                    <li>
                        <a href="#phase1-kali-install">3. Phase 1 – Kali Purple Installation</a>
                        <ul>
                            <li><a href="#phase1-usb">3.1 Create Kali Purple USB (Windows 11 + Rufus)</a></li>
                            <li><a href="#phase1-bios">3.2 Configure BIOS/UEFI</a></li>
                            <li><a href="#phase1-wizard">3.3 Installation Wizard Walkthrough</a></li>
                            <li><a href="#phase1-partitioning">3.4 Disk Partitioning</a></li>
                            <li><a href="#phase1-first-boot">3.5 First Boot &amp; Basic Hardening</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#phase2-platform-install">4. Phase 2 – Platform Installation</a>
                        <ul>
                            <li><a href="#phase2-transfer">4.1 Transfer Package to Kali Purple</a></li>
                            <li><a href="#phase2-master-setup">4.2 Run <span class="mono">master_setup.sh</span> (with pre-flight)</a></li>
                            <li><a href="#phase2-config-wizard">4.3 Configuration Template Selection</a></li>
                            <li><a href="#phase2-services">4.4 Launchers, Sync, and Optional Services</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#phase3-validation-testing">5. Phase 3 – Validation &amp; Testing</a>
                        <ul>
                            <li><a href="#phase3-ownership">5.1 Ownership &amp; Permissions Verification</a></li>
                            <li><a href="#phase3-test-scans">5.2 Safe Test Scans</a></li>
                            <li><a href="#phase3-dashboard-logs">5.3 Dashboard &amp; Log Inspection</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#phase4-production">6. Phase 4 – Production Deployment</a>
                        <ul>
                            <li><a href="#phase4-prep">6.1 Client Site Preparation Checklist</a></li>
                            <li><a href="#phase4-network-discovery">6.2 Network Discovery &amp; Auto-Detection</a></li>
                            <li><a href="#phase4-scan-execution">6.3 Scan Execution Strategy</a></li>
                            <li><a href="#phase4-reporting-evidence">6.4 Reporting &amp; Evidence Collection</a></li>
                        </ul>
                    </li>
                    <li><a href="#troubleshooting-main">7. Troubleshooting Guide (Overview)</a></li>
                    <li><a href="#appendix-a-master-setup">Appendix A – <span class="mono">master_setup.sh</span> Complete Source</a></li>
                    <li><a href="#appendix-b-python-scripts">Appendix B – Python Scripts (23) Overview</a></li>
                    <li><a href="#appendix-c-config-templates">Appendix C – Configuration Templates (5) – Full YAML</a></li>
                    <li><a href="#appendix-d-decision-trees">Appendix D – Troubleshooting Decision Trees</a></li>
                    <li><a href="#appendix-e-network-diagrams">Appendix E – Network Diagram Templates</a></li>
                    <li><a href="#appendix-f-compliance">Appendix F – Compliance Framework Mapping</a></li>
                    <li><a href="#appendix-g-commands">Appendix G – Complete Command Reference</a></li>
                    <li><a href="#appendix-h-recovery">Appendix H – Recovery Procedures</a></li>
                </ul>
            </div>

            <!-- 1. INTRODUCTION -->
            <section id="introduction-overview">
                <h2>1. Introduction &amp; Overview</h2>

                <p>
                    The Purple Team GRC Platform v3.0 is a <strong>production‑ready security assessment and GRC automation suite</strong>
                    built on top of <strong>Kali Purple</strong>. It gives consultants and internal teams a walk‑in‑ready laptop
                    that can be dropped into any client environment and used to:
                </p>
                <ul>
                    <li>Discover networks and assets (wired and wireless)</li>
                    <li>Run vulnerability and configuration scans</li>
                    <li>Map results to compliance frameworks (SOC 2, HIPAA, SOX, PCI‑DSS, FedRAMP, etc.)</li>
                    <li>Generate executive reports and audit‑ready evidence packages</li>
                </ul>

                <div class="callout info">
                    <div class="callout-title">ZERO-KNOWLEDGE APPROACH</div>
                    <p>
                        This guide assumes you have <strong>never used Linux before</strong>. Every command is shown, explained in plain
                        English, and followed by a <strong>“What you'll see”</strong> description so you can confirm you are on track.
                    </p>
                </div>

                <h3>1.1 Who This Guide Is For</h3>
                <ul>
                    <li><strong>Security consultants</strong> doing on‑site assessments</li>
                    <li><strong>Internal audit / compliance teams</strong> needing repeatable evidence collection</li>
                    <li><strong>Security engineers</strong> building a portable GRC and assessment toolkit</li>
                </ul>

                <h3>1.2 High-Level Deployment Phases</h3>
                <ol>
                    <li><strong>Phase 1 – Kali Purple Installation:</strong> build the base OS on a laptop.</li>
                    <li><strong>Phase 2 – Platform Installation:</strong> install the Purple Team GRC Platform onto Kali Purple.</li>
                    <li><strong>Phase 3 – Validation &amp; Testing:</strong> verify permissions, run safe test scans, and check logs.</li>
                    <li><strong>Phase 4 – Production Deployment:</strong> take the platform to a client site and run real engagements.</li>
                </ol>
            </section>

            <!-- 2. PREREQUISITES -->
            <section id="prerequisites-planning">
                <h2>2. Prerequisites &amp; Planning</h2>

                <h3>2.1 Hardware Requirements (Recommended)</h3>
                <table>
                    <tr><th>Component</th><th>Minimum</th><th>Recommended</th></tr>
                    <tr><td>Laptop Model</td><td>Any modern 64‑bit laptop</td><td>HP EliteBook 840 G9 or similar business laptop</td></tr>
                    <tr><td>CPU</td><td>4 cores</td><td>8+ cores</td></tr>
                    <tr><td>Memory (RAM)</td><td>8 GB</td><td>16 GB (32 GB for large networks)</td></tr>
                    <tr><td>Storage</td><td>256 GB SSD</td><td>512 GB–1 TB NVMe SSD</td></tr>
                    <tr><td>Networking</td><td>Wi‑Fi</td><td>Gigabit Ethernet + Wi‑Fi 6</td></tr>
                </table>

                <h3>2.2 Software Requirements</h3>
                <ul>
                    <li><strong>Kali Purple</strong> ISO image (latest stable)</li>
                    <li><strong>Windows 11</strong> workstation with <strong>Rufus</strong> to create the USB installer</li>
                    <li>On Kali Purple: <strong>Python 3.10+</strong> (3.11+ recommended)</li>
                    <li>Internet access for installing packages (can be limited or proxied, but easier with direct access)</li>
                </ul>

                <h3>2.3 Network &amp; Time Planning</h3>
                <table>
                    <tr><th>Task</th><th>Estimated Time</th><th>Notes</th></tr>
                    <tr><td>Create Kali Purple USB</td><td>15–30 minutes</td><td>Depends on download speed and USB write speed</td></tr>
                    <tr><td>Install Kali Purple</td><td>20–40 minutes</td><td>Includes partitioning and first boot</td></tr>
                    <tr><td>Run <span class="mono">master_setup.sh</span></td><td>10–20 minutes</td><td>Longer on slow networks</td></tr>
                    <tr><td>First validation &amp; test scans</td><td>30–60 minutes</td><td>Includes reviewing logs and results</td></tr>
                </table>

                <div class="callout warning">
                    <div class="callout-title">PLAN MAINTENANCE WINDOWS</div>
                    <p>
                        For client environments, schedule scans during <strong>low‑traffic or maintenance windows</strong>.
                        Some scans can be noisy if misconfigured. Templates in this platform are conservative, but
                        good planning is still essential.
                    </p>
                </div>
            </section>

            <!-- 3. PHASE 1 – KALI PURPLE INSTALL -->
            <section id="phase1-kali-install">
                <h2>3. Phase 1 – Kali Purple Installation</h2>

                <p>
                    In this phase you will download Kali Purple, create a bootable USB using Rufus on Windows 11,
                    configure the laptop’s BIOS/UEFI to boot from USB, and complete the Kali Purple installation wizard.
                </p>

                <h3 id="phase1-usb">3.1 Create Kali Purple USB (Windows 11 + Rufus)</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <div class="step-title">Download Kali Purple ISO on Windows 11</div>
                    </div>
                    <p>
                        On your Windows 11 machine (not the target laptop), open a web browser and download the latest
                        Kali Linux ISO that specifically mentions <strong>Kali Purple</strong>.
                    </p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A single <span class="mono">.iso</span> file (e.g.,
                        <span class="mono">kali-linux-2024.4-purple-amd64.iso</span>) in your Downloads folder.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <div class="step-title">Install and start Rufus</div>
                    </div>
                    <p>
                        Download Rufus (a popular USB imaging tool) from its official site and run it. No installation
                        is usually required – it runs as a single executable.
                    </p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A small window titled “Rufus” with fields for
                        <em>Device</em>, <em>Boot selection</em>, and <em>Partition scheme</em>.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <div class="step-title">Write the Kali Purple ISO to USB</div>
                    </div>
                    <ul>
                        <li>Insert an empty USB drive (8 GB or larger) into your Windows 11 machine.</li>
                        <li>In Rufus, choose that USB drive under <em>Device</em>.</li>
                        <li>Click <em>Select</em> and choose the Kali Purple ISO file you downloaded.</li>
                        <li>Leave other options at defaults (GPT / UEFI for modern laptops).</li>
                        <li>Click <em>Start</em> and confirm when Rufus warns that data will be erased.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A progress bar that goes from 0% to 100%.  
                        When it completes, Rufus shows “Ready” and your USB drive now contains a bootable Kali Purple installer.
                    </div>
                </div>

                <h3 id="phase1-bios">3.2 Configure BIOS/UEFI</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">4</div>
                        <div class="step-title">Enter BIOS/UEFI setup</div>
                    </div>
                    <p>
                        Plug the new Kali Purple USB into the <strong>target laptop</strong>.
                        Power it on and press the BIOS key repeatedly (often <strong>F10</strong>, <strong>F2</strong>, or <strong>Esc</strong>
                        depending on the model). For HP EliteBook this is typically <strong>F10</strong>.
                    </p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A blue or gray BIOS/UEFI screen with menus such as
                        <em>System Configuration</em>, <em>Boot Options</em>, etc.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">5</div>
                        <div class="step-title">Set USB as first boot device</div>
                    </div>
                    <ul>
                        <li>Find the <strong>Boot</strong> or <strong>Boot Order</strong> menu.</li>
                        <li>Move the USB drive entry to the top of the boot order list.</li>
                        <li>Ensure <strong>UEFI</strong> boot is enabled (recommended for modern systems).</li>
                        <li>Save changes and exit (often <strong>F10</strong> then “Yes”).</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> The laptop restarts and, if configured correctly, boots
                        straight into the Kali installer menu from the USB drive.
                    </div>
                </div>

                <h3 id="phase1-wizard">3.3 Kali Purple Installation Wizard</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">6</div>
                        <div class="step-title">Start the graphical installer</div>
                    </div>
                    <p>
                        On the Kali boot menu, choose <strong>Graphical install</strong>. Use the arrow keys to move and
                        <strong>Enter</strong> to select.
                    </p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A series of installer screens asking for language, location,
                        keyboard, hostname, user account, and disk layout.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">7</div>
                        <div class="step-title">Fill in basic information</div>
                    </div>
                    <ul>
                        <li><strong>Language / Location / Keyboard:</strong> Choose your normal preferences.</li>
                        <li><strong>Hostname:</strong> Use something descriptive like <span class="mono">purple-laptop</span>.</li>
                        <li><strong>User account:</strong> Create a normal user (e.g., <span class="mono">consultant</span>).
                            You will use this account daily; <span class="mono">root</span> is only for system tasks.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A progress bar as the installer copies files after you confirm disk
                        layout in the next step.
                    </div>
                </div>

                <h3 id="phase1-partitioning">3.4 Disk Partitioning</h3>

                <div class="callout warning">
                    <div class="callout-title">DISK WARNING</div>
                    <p>
                        The next step <strong>erases the laptop’s existing data</strong>. Ensure there is no data you need
                        on this laptop before proceeding.
                    </p>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">8</div>
                        <div class="step-title">Choose guided partitioning (recommended)</div>
                    </div>
                    <ul>
                        <li>When asked for partitioning, choose <strong>Guided – use entire disk</strong>.</li>
                        <li>Select the main disk (often <span class="mono">/dev/nvme0n1</span> or similar).</li>
                        <li>Choose “All files in one partition” unless you have a reason to split <span class="mono">/home</span>.</li>
                        <li>Confirm that you are OK with writing changes to disk.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> After confirmation, the installer shows progress “Installing the system”.
                        This may take several minutes.
                    </div>
                </div>

                <h3 id="phase1-first-boot">3.5 First Boot &amp; Basic Hardening</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">9</div>
                        <div class="step-title">Remove USB and reboot into Kali Purple</div>
                    </div>
                    <p>
                        When installation completes, the installer prompts you to reboot. Remove the USB drive when prompted
                        (or when the system restarts) so the laptop boots from the internal disk.
                    </p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A Kali login screen. Log in using the normal user you created
                        (e.g., <span class="mono">consultant</span>).
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">10</div>
                        <div class="step-title">Verify you have Kali Purple, not standard Kali</div>
                    </div>
                    <p>Open a terminal (look for the black terminal icon) and run:</p>
                    <pre><code class="language-bash">cat /etc/os-release | grep -i kali
dpkg -l | grep kali-linux-purple || echo "kali-linux-purple not installed"</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li>The first command prints information about the installed Linux distribution.</li>
                        <li>The second command checks whether the <span class="mono">kali-linux-purple</span> package is installed.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> Lines mentioning Kali Linux. If “kali-linux-purple” does
                        <strong>not</strong> appear, you can install it with:
                        <pre><code class="language-bash">sudo apt update
sudo apt install -y kali-linux-purple</code></pre>
                        <span class="small"><strong>Explanation:</strong> <span class="mono">sudo</span> runs a command as an
                        administrator. <span class="mono">apt</span> is the package manager that installs software.</span>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-title">Checkpoint – Phase 1 Complete</div>
                    <ul class="checklist">
                        <li>You can boot into Kali Purple and log in as your normal user.</li>
                        <li>A terminal opens successfully.</li>
                        <li>The package <span class="mono">kali-linux-purple</span> is installed (or you have installed it).</li>
                    </ul>
                </div>
            </section>

            <!-- 4. PHASE 2 – PLATFORM INSTALLATION -->
            <section id="phase2-platform-install">
                <h2>4. Phase 2 – Platform Installation</h2>

                <p>
                    In this phase you will transfer the Purple Team GRC Platform files to Kali Purple and run
                    <strong><span class="mono">master_setup.sh</span></strong>, which performs:
                </p>
                <ul>
                    <li>Pre‑flight system checks (OS, disk, RAM, Python version, tools)</li>
                    <li>Creation of the dual installation:
                        <span class="mono">/opt/purple-team</span> (system‑wide) and <span class="mono">~/.purple-team</span> (per‑user)</li>
                    <li>Python virtual environments</li>
                    <li>Copying all scanners/utilities</li>
                    <li>Installing terminal and GUI launchers</li>
                    <li>Configuring the sync manager</li>
                </ul>

                <h3 id="phase2-transfer">4.1 Transfer the Platform Package to Kali Purple</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <div class="step-title">Copy the package onto the laptop</div>
                    </div>
                    <p>You can use any of the following methods:</p>
                    <ul>
                        <li>Copy the project folder onto a USB drive and then onto the laptop.</li>
                        <li>Use <span class="mono">scp</span> from another machine (advanced users).</li>
                        <li>Share via a network share and mount it in Kali.</li>
                    </ul>
                    <p>Once copied, you should have a directory on Kali, for example:</p>
                    <pre><code class="language-bash">cd ~/Downloads
ls</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li><span class="mono">cd ~/Downloads</span> changes directory into your Downloads folder.</li>
                        <li><span class="mono">ls</span> lists files in the current directory.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A folder such as <span class="mono">purple-team-package-v3.0</span>.
                        We will run the setup script from inside that folder.
                    </div>
                </div>

                <h3 id="phase2-master-setup">4.2 Run <span class="mono">master_setup.sh</span> with Pre-flight Checks</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <div class="step-title">Make the setup script executable</div>
                    </div>
                    <pre><code class="language-bash">cd ~/Downloads/purple-team-package-v3.0
chmod +x master_setup.sh</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li><span class="mono">chmod +x master_setup.sh</span> tells Linux that this file is allowed to be run as a program.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> No news is good news – <span class="mono">chmod</span>
                        normally produces no output if it succeeds.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <div class="step-title">Run the master setup script as administrator</div>
                    </div>
                    <pre><code class="language-bash">sudo ./master_setup.sh</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li><span class="mono">sudo</span> temporarily runs the command with administrator (root) privileges.</li>
                        <li><span class="mono">./master_setup.sh</span> executes the script in the current directory.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong>
                    </div>
                    <ul>
                        <li>A banner for “Purple Team GRC Platform – Master Setup v3.0”.</li>
                        <li>Questions asking if you want to continue, update packages, install tools, etc.</li>
                        <li>Color‑coded messages such as “Pre-flight Check Summary” and “All critical checks passed”.</li>
                    </ul>
                </div>

                <div class="callout info">
                    <div class="callout-title">INTERPRETING PRE-FLIGHT CHECKS</div>
                    <p>
                        During <span class="mono">run_preflight_checks</span>, the script verifies:
                    </p>
                    <ul>
                        <li>Your OS is Kali (and ideally Kali Purple).</li>
                        <li>You have internet connectivity (or warns if not).</li>
                        <li>You have enough disk space and RAM.</li>
                        <li>Your Python version is compatible (3.10+).</li>
                        <li>Essential tools and packages are installed.</li>
                    </ul>
                    <p>
                        Warnings do <strong>not</strong> always stop installation. Errors will either:
                    <ul>
                        <li>Ask you if you want to continue anyway, or</li>
                        <li>Exit if something is truly incompatible (for example, no Python 3).</li>
                    </ul>
                    </p>
                </div>

                <h3 id="phase2-config-wizard">4.3 Configuration Template Selection (Industry Wizard)</h3>

                <p>
                    Inside <span class="mono">master_setup.sh</span> (full code in Appendix A), the function
                    <span class="mono">create_config_files</span> and related logic copy configuration templates and build
                    <span class="mono">~/.purple-team/config.yaml</span> for the current user.
                </p>

                <div class="callout info">
                    <div class="callout-title">INDUSTRY TEMPLATES</div>
                    <p>The following templates are available and installed to <span class="mono">/opt/purple-team/config/</span>:</p>
                    <ul>
                        <li><span class="mono">config-healthcare.yaml</span> – HIPAA / HITECH / FDA 21 CFR Part 11</li>
                        <li><span class="mono">config-finance.yaml</span> – SOX / PCI‑DSS / GLBA / FFIEC</li>
                        <li><span class="mono">config-retail.yaml</span> – PCI‑DSS / CCPA</li>
                        <li><span class="mono">config-government.yaml</span> – FedRAMP / FISMA / NIST 800‑53 / CMMC</li>
                        <li><span class="mono">config-template.yaml</span> – Generic template</li>
                    </ul>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">4</div>
                        <div class="step-title">Confirm directory structure creation</div>
                    </div>
                    <p>
                        The script calls <span class="mono">create_directory_structure</span> and prints the paths it creates.
                        It will create:
                    </p>
                    <ul>
                        <li>System directories such as <span class="mono">/opt/purple-team/scanners</span>,
                            <span class="mono">/opt/purple-team/utils</span>, <span class="mono">/opt/purple-team/config</span>, etc.</li>
                        <li>User directories such as <span class="mono">~/.purple-team/config</span>,
                            <span class="mono">~/.purple-team/results</span>, <span class="mono">~/.purple-team/logs</span>, and
                            <span class="mono">~/.purple-team/venv</span>.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> Lines like “Created: /opt/purple-team/scanners” and
                        “Created: /home/consultant/.purple-team/results”.
                    </div>
                </div>

                <h3 id="phase2-services">4.4 Launchers, Sync Manager, and Optional Services</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">5</div>
                        <div class="step-title">Install terminal and GUI launchers</div>
                    </div>
                    <p>Near the end of the script, <span class="mono">install_launchers</span> does the following:</p>
                    <ul>
                        <li>Copies <span class="mono">purple-team-launcher</span> to
                            <span class="mono">/usr/local/bin/purple-team-launcher</span>.</li>
                        <li>Copies <span class="mono">purple-team-gui</span> to
                            <span class="mono">/usr/local/bin/purple-team-gui</span>.</li>
                        <li>Copies <span class="mono">sync-manager.sh</span> to
                            <span class="mono">/usr/local/bin/purple-team-sync</span>.</li>
                    </ul>
                    <p>You can confirm this afterwards with:</p>
                    <pre><code class="language-bash">which purple-team-launcher
which purple-team-gui
which purple-team-sync</code></pre>
                    <p><strong>Explanation:</strong> <span class="mono">which</span> tells you the full path that will be executed
                        when you type that command.</p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> Each command prints a path under <span class="mono">/usr/local/bin/</span>
                        if the launcher is correctly installed.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">6</div>
                        <div class="step-title">Initial sync between system and user installations</div>
                    </div>
                    <p>
                        The function <span class="mono">setup_sync_manager</span> runs the initial sync using
                        <span class="mono">sync-manager.sh</span> and optionally adds an hourly cron job.
                    </p>
                    <pre><code class="language-bash"># You can manually trigger a sync at any time:
purple-team-sync</code></pre>
                    <p><strong>Explanation:</strong> This keeps the system installation at
                        <span class="mono">/opt/purple-team</span> and your user copy at <span class="mono">~/.purple-team</span>
                        aligned. You always work out of the user space, but system files are the canonical source.
                    </p>
                </div>

                <div class="checkpoint" id="post-install-verification">
                    <div class="checkpoint-title">Critical Post-Installation Verification</div>
                    <p>
                        Immediately after <span class="mono">master_setup.sh</span> finishes, verify that the main
                        configuration file is owned by <strong>your user</strong> (not <span class="mono">root</span>).
                    </p>
                    <pre><code class="language-bash">ls -l ~/.purple-team/config.yaml</code></pre>
                    <p><strong>Explanation:</strong> <span class="mono">ls -l</span> lists the file with permissions and ownership.
                        The third and fourth columns are the <strong>owner</strong> and <strong>group</strong>.</p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A line similar to:
                        <pre><code class="language-text">-rw-r--r-- 1 consultant consultant 4096 Jan  2 12:34 /home/consultant/.purple-team/config.yaml</code></pre>
                        <ul>
                            <li>The first <span class="mono">consultant</span> is the owner. It <strong>must</strong> be your user,
                                <strong>not</strong> <span class="mono">root</span>.</li>
                        </ul>
                    </div>
                    <div class="callout critical">
                        <div class="callout-title">IF OWNERSHIP IS WRONG</div>
                        <p>If you see <span class="mono">root root</span> instead of your user:</p>
                        <pre><code class="language-bash">sudo chown "$USER:$USER" ~/.purple-team/config.yaml
ls -l ~/.purple-team/config.yaml</code></pre>
                        <p><strong>Explanation:</strong> <span class="mono">chown</span> changes the owner and group back to your
                            normal account so the platform can read and write configuration without permission errors.</p>
                    </div>
                </div>
            </section>

            <!-- 5. PHASE 3 – VALIDATION & TESTING -->
            <section id="phase3-validation-testing">
                <h2>5. Phase 3 – Validation &amp; Testing</h2>

                <p>
                    Now that the platform is installed, you will verify file ownership and permissions, run safe local scans,
                    check the dashboard, and review logs. This ensures the laptop is ready for real client work.
                </p>

                <h3 id="phase3-ownership">5.1 Ownership &amp; Permissions Verification</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <div class="step-title">Verify dual installation directories</div>
                    </div>
                    <pre><code class="language-bash">ls -ld /opt/purple-team
ls -ld ~/.purple-team</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li>The first command confirms the system‑wide installation directory exists.</li>
                        <li>The second confirms the per‑user directory exists and is accessible.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong>
                        <ul>
                            <li><span class="mono">/opt/purple-team</span> owned by <span class="mono">root</span>.</li>
                            <li><span class="mono">~/.purple-team</span> owned by your user.</li>
                        </ul>
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <div class="step-title">Re-check configuration file ownership</div>
                    </div>
                    <pre><code class="language-bash">ls -l ~/.purple-team/config.yaml</code></pre>
                    <p>
                        Confirm again that the file is owned by your user as described in the critical checkpoint in Phase 2.
                        This is the <strong>single most common cause</strong> of permission issues.
                    </p>
                </div>

                <h3 id="phase3-test-scans">5.2 Safe Test Scans (Localhost Only)</h3>

                <div class="callout info">
                    <div class="callout-title">TEST TARGET</div>
                    <p>
                        For initial validation, you will scan only <span class="mono">localhost</span> (the laptop itself).
                        This is safe and does not touch any external systems.
                    </p>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <div class="step-title">Launch the terminal menu</div>
                    </div>
                    <pre><code class="language-bash">purple-team-launcher</code></pre>
                    <p><strong>Explanation:</strong> This starts the interactive menu application. It handles activating the Python
                        environment, checking paths, and launching tools for you.</p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A full‑screen text menu with options like:
                        <ul>
                            <li>Run Pre-flight Check</li>
                            <li>Network Discovery</li>
                            <li>Vulnerability Scan</li>
                            <li>Integrated GRC Scan</li>
                            <li>View Results</li>
                        </ul>
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">4</div>
                        <div class="step-title">Run a quick network scan against localhost</div>
                    </div>
                    <p>
                        From the launcher, choose an option like <strong>Quick Scan</strong> or, manually from a terminal:
                    </p>
                    <pre><code class="language-bash">python3 /opt/purple-team/scanners/network_scanner.py --targets 127.0.0.1</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li><span class="mono">python3</span> runs the Python interpreter.</li>
                        <li><span class="mono">network_scanner.py</span> is the script that performs network discovery.</li>
                        <li><span class="mono">--targets 127.0.0.1</span> tells it to only scan the local machine.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> Logging messages and, at the end, a summary indicating it scanned one host
                        and wrote results under <span class="mono">~/.purple-team/results/network-scans/</span>.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">5</div>
                        <div class="step-title">View the generated results file</div>
                    </div>
                    <pre><code class="language-bash">ls ~/.purple-team/results/network-scans
cat ~/.purple-team/results/network-scans/&lt;your-scan-file>.json | head -40</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li>The <span class="mono">ls</span> command lists your network scan result files.</li>
                        <li><span class="mono">cat ... | head -40</span> shows the first 40 lines of the JSON output.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A JSON file whose name includes the date/time of the scan,
                        and structured data describing the ports found on <span class="mono">127.0.0.1</span>.
                    </div>
                </div>

                <h3 id="phase3-dashboard-logs">5.3 Dashboard &amp; Log Inspection</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">6</div>
                        <div class="step-title">Start the dashboard (if using the web interface)</div>
                    </div>
                    <pre><code class="language-bash">python3 /opt/purple-team/dashboard_app.py</code></pre>
                    <p><strong>Explanation:</strong> Launches the Flask web dashboard. By default it listens on
                        <span class="mono">127.0.0.1:5000</span>, which means it is only accessible on the laptop itself.</p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> Log messages about the Flask app starting. In a web browser on the same
                        machine, go to <span class="mono">http://127.0.0.1:5000</span> to see summary tiles, charts, and links to reports.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">7</div>
                        <div class="step-title">Check logs for errors</div>
                    </div>
                    <pre><code class="language-bash">ls ~/.purple-team/logs
tail -50 ~/.purple-team/logs/network_scanner.log</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li><span class="mono">ls</span> shows all platform log files.</li>
                        <li><span class="mono">tail -50</span> prints the last 50 lines of a given log.</li>
                    </ul>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> Log lines with timestamps, log levels (INFO/WARNING/ERROR),
                        and messages about completed scans. There should be no unhandled tracebacks or permission errors.
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-title">Checkpoint – Platform Validation Complete</div>
                    <ul class="checklist">
                        <li><span class="mono">/opt/purple-team</span> and <span class="mono">~/.purple-team</span> both exist.</li>
                        <li><span class="mono">~/.purple-team/config.yaml</span> is owned by your user.</li>
                        <li><span class="mono">purple-team-launcher</span> runs and shows the menu.</li>
                        <li>You can run a safe localhost scan and see results and logs.</li>
                    </ul>
                </div>
            </section>

            <!-- 6. PHASE 4 – PRODUCTION DEPLOYMENT -->
            <section id="phase4-production">
                <h2>6. Phase 4 – Production Deployment</h2>

                <p>
                    At this point your laptop is a fully functioning Purple Team GRC platform. This phase covers how to
                    use it safely and effectively in a real client environment.
                </p>

                <h3 id="phase4-prep">6.1 Client Site Preparation Checklist</h3>

                <div class="callout warning">
                    <div class="callout-title">PRE-ENGAGEMENT CHECKLIST</div>
                    <ul>
                        <li>Signed authorization letter that explicitly permits scanning the client networks.</li>
                        <li>Defined scope (which IP ranges, which systems, which environments).</li>
                        <li>Approved maintenance windows and change control where required.</li>
                        <li>Points of contact for operations, security, and compliance teams.</li>
                    </ul>
                </div>

                <ul>
                    <li>Ensure the laptop is fully charged and has its power adapter.</li>
                    <li>Bring at least one Ethernet cable and any required USB‑to‑Ethernet adapters.</li>
                    <li>Have an encrypted backup of any previous client data stored separately.</li>
                </ul>

                <h3 id="phase4-network-discovery">6.2 Network Discovery &amp; Auto-Detection</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <div class="step-title">Connect to client network</div>
                    </div>
                    <p>
                        Connect via wired Ethernet when possible. This gives more reliable results and usually access to
                        more internal ranges.
                    </p>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <div class="step-title">Run network auto-detection</div>
                    </div>
                    <pre><code class="language-bash">purple-team-launcher   # then choose "Network Discovery"
# OR run directly:
python3 /opt/purple-team/utils/network-detector.py</code></pre>
                    <p><strong>Explanation:</strong> <span class="mono">network-detector.py</span> scans the active network
                        interfaces for private (RFC1918) ranges and updates <span class="mono">~/.purple-team/config.yaml</span>
                        with discovered ranges.
                    </p>
                    <div class="what-youll-see">
                        <strong>What you'll see:</strong> A list of discovered ranges such as
                        <span class="mono">10.50.0.0/16</span> or <span class="mono">192.168.10.0/24</span>, followed by a message
                        stating that the configuration file has been updated.
                    </div>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <div class="step-title">Review and adjust the configuration file</div>
                    </div>
                    <pre><code class="language-bash">nano ~/.purple-team/config.yaml</code></pre>
                    <p><strong>Explanation:</strong> <span class="mono">nano</span> is a simple text editor inside the terminal.</p>
                    <ul>
                        <li>Scroll to the <span class="mono">network:</span> section.</li>
                        <li>Review <span class="mono">ranges:</span> and <span class="mono">exclusions:</span>
                            with the client. Add exclusions for critical systems that must not be scanned.</li>
                        <li>Ensure <span class="mono">auto_detect: true</span> is appropriate, or switch to manual ranges if required.</li>
                    </ul>
                </div>

                <h3 id="phase4-scan-execution">6.3 Scan Execution Strategy</h3>

                <div class="callout info">
                    <div class="callout-title">TYPICAL ENGAGEMENT FLOW</div>
                    <ol>
                        <li>Run a <strong>network discovery scan</strong> to identify live hosts.</li>
                        <li>Run a <strong>vulnerability scan</strong> limited to in-scope ranges.</li>
                        <li>Run the <strong>integrated GRC scanner</strong> to correlate with compliance frameworks.</li>
                        <li>Generate <strong>executive and technical reports</strong> and export evidence.</li>
                    </ol>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">4</div>
                        <div class="step-title">Run an in-scope network scan</div>
                    </div>
                    <pre><code class="language-bash">python3 /opt/purple-team/scanners/network_scanner.py</code></pre>
                    <p>
                        The scanner reads the target ranges from <span class="mono">config.yaml</span> and respects stealth
                        and timing settings appropriate to the industry template (for example, slower for healthcare).
                    </p>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">5</div>
                        <div class="step-title">Run vulnerability and compliance scans</div>
                    </div>
                    <pre><code class="language-bash"># Vulnerability assessment
python3 /opt/purple-team/scanners/vulnerability_scanner.py

# Compliance mapping
python3 /opt/purple-team/scanners/compliance_checker.py

# All-in-one integrated GRC scan
python3 /opt/purple-team/scanners/integrated_grc_scanner.py</code></pre>
                    <p><strong>Explanation:</strong></p>
                    <ul>
                        <li><span class="mono">vulnerability_scanner.py</span> collects technical findings.</li>
                        <li><span class="mono">compliance_checker.py</span> maps findings to frameworks like SOC 2, HIPAA, PCI‑DSS.</li>
                        <li><span class="mono">integrated_grc_scanner.py</span> orchestrates risk scoring and evidence management.</li>
                    </ul>
                </div>

                <h3 id="phase4-reporting-evidence">6.4 Reporting &amp; Evidence Collection</h3>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">6</div>
                        <div class="step-title">Generate executive reports</div>
                    </div>
                    <pre><code class="language-bash">python3 /opt/purple-team/utilities/executive_report_generator.py</code></pre>
                    <p>
                        This utility creates a one‑page summary suitable for leadership, with high‑level metrics such as
                        number of critical findings, compliance rate, and systems scanned.
                    </p>
                </div>

                <div class="step">
                    <div class="step-header">
                        <div class="step-number">7</div>
                        <div class="step-title">Package evidence for audit support</div>
                    </div>
                    <pre><code class="language-bash">python3 /opt/purple-team/utilities/evidence_manager.py --create-package</code></pre>
                    <p>
                        Evidence packages are stored under <span class="mono">~/.purple-team/results/evidence/</span> and can
                        be provided to auditors, with references to specific control requirements (see Appendices C and F).
                    </p>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-title">Checkpoint – Ready for Ongoing Engagements</div>
                    <ul class="checklist">
                        <li>Client‑specific <span class="mono">config.yaml</span> is customized and validated.</li>
                        <li>Network discovery and vulnerability scans complete with acceptable impact.</li>
                        <li>Compliance reports generated and mapped to the client’s frameworks.</li>
                        <li>Evidence packages and executive summaries are produced and stored securely.</li>
                    </ul>
                </div>
            </section>

            <!-- 7. TROUBLESHOOTING OVERVIEW -->
            <section id="troubleshooting-main">
                <h2>7. Troubleshooting Guide (Overview)</h2>

                <p>
                    This section summarizes the most common problems and where to look. Detailed decision trees are provided
                    in <a href="#appendix-d-decision-trees">Appendix D</a>.
                </p>

                <h3>7.1 Permission Issues (Most Common)</h3>
                <ul>
                    <li><strong>Symptoms:</strong> “Permission denied”, “Could not write results”, or Python tracebacks mentioning permissions.</li>
                    <li><strong>First checks:</strong></li>
                </ul>
                <pre><code class="language-bash">ls -ld ~/.purple-team
ls -l ~/.purple-team/config.yaml
whoami</code></pre>
                <p>
                    Ensure your user owns <span class="mono">~/.purple-team</span> and
                    <span class="mono">config.yaml</span>. If not:
                </p>
                <pre><code class="language-bash">sudo chown -R "$USER:$USER" ~/.purple-team</code></pre>

                <h3>7.2 Network Problems</h3>
                <ul>
                    <li><strong>Symptoms:</strong> No hosts found, timeouts, or “No RFC1918 networks detected”.</li>
                </ul>
                <pre><code class="language-bash">ip addr show
ip route show
ping -c 2 8.8.8.8 || echo "No Internet"
python3 /opt/purple-team/utils/network-detector.py --verbose</code></pre>

                <h3>7.3 Tool Failures (Nmap, Nuclei, etc.)</h3>
                <ul>
                    <li><strong>Symptoms:</strong> Scanner scripts complain that a tool is missing.</li>
                </ul>
                <pre><code class="language-bash">sudo /opt/purple-team/utils/pre-flight-checker.py</code></pre>
                <p>
                    Re‑run the pre‑flight checker. It will list missing tools and suggest installation commands.
                </p>

                <h3>7.4 Python Errors</h3>
                <ul>
                    <li><strong>Symptoms:</strong> “ModuleNotFoundError”, “ImportError”, or unexpected tracebacks.</li>
                </ul>
                <pre><code class="language-bash"># Activate the system venv and try again
source /opt/purple-team/venv/bin/activate
python3 /opt/purple-team/scanners/network_scanner.py --help</code></pre>
                <p>
                    If the error disappears in the virtual environment, ensure you always use the launcher or that venv.
                    If errors persist, re‑run <span class="mono">master_setup.sh</span> to reinstall dependencies.
                </p>
            </section>

            <!-- APPENDIX A – MASTER_SETUP.SH COMPLETE CODE -->
            <section id="appendix-a-master-setup">
                <h2>Appendix A – <span class="mono">master_setup.sh</span> Complete Source Code</h2>
                <p>
                    This is the full v3.0 master setup script (all lines) used during installation. It includes
                    pre‑flight checks, dual installation creation, Python environment setup, configuration file handling,
                    launcher installation, sync manager configuration, and final verification steps.
                </p>

                <pre><code class="language-bash">#!/bin/bash
####
# Purple Team GRC Platform - Master Setup Script v3.0
# Description: Production-ready installation with dual-location support,
#              pre-flight validation, auto-sync, and launcher integration
# Author: Internal Security Team
# Version: 3.0 - Complete Rebuild for Professional Deployment
# FIX: Corrected user directory detection when running with sudo
####

set -e  # Exit on error
set -u  # Exit on undefined variable

####
# CRITICAL FIX: Detect actual user and home directory FIRST
####
# This must be at the top before any directory definitions
# When running with sudo, $HOME resolves to /root, which is wrong
# We need the actual user's home directory, not root's

if [ -n "${SUDO_USER:-}" ]; then
    ACTUAL_USER="$SUDO_USER"
    ACTUAL_HOME=$(eval echo ~$SUDO_USER)
else
    ACTUAL_USER="$(whoami)"
    ACTUAL_HOME="$HOME"
fi

####
# VARIABLES & CONFIGURATION
####

# Version information
VERSION="3.0"
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Installation locations - NOW using ACTUAL_HOME instead of $HOME
SYSTEM_INSTALL_DIR="/opt/purple-team"
USER_INSTALL_DIR="$ACTUAL_HOME/.purple-team"

# Color codes for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
MAGENTA='\033[0;35m'
NC='\033[0m' # No Color

# Log file locations
SYSTEM_LOG_DIR="/var/log/purple-team"
USER_LOG_DIR="$ACTUAL_HOME/.purple-team/logs"
SETUP_LOG="$SYSTEM_LOG_DIR/setup.log"

# Create log directory if needed
mkdir -p "$SYSTEM_LOG_DIR" 2>/dev/null || SETUP_LOG="/tmp/purple_team_setup.log"
exec > >(tee -a "$SETUP_LOG") 2>&1

####
# HELPER FUNCTIONS
####

print_header() {
    echo ""
    echo -e "${BLUE}====${NC}"
    echo -e "${BLUE} $1${NC}"
    echo -e "${BLUE}====${NC}"
    echo ""
}

print_success() {
    echo -e "${GREEN}✓ $1${NC}"
}

print_error() {
    echo -e "${RED}✗ $1${NC}"
}

print_warning() {
    echo -e "${YELLOW}⚠ $1${NC}"
}

print_info() {
    echo -e "${CYAN}ℹ $1${NC}"
}

print_section() {
    echo ""
    echo -e "${MAGENTA}────${NC}"
    echo -e "${MAGENTA}▶ $1${NC}"
    echo -e "${MAGENTA}────${NC}"
}

check_root() {
    if [[ $EUID -ne 0 ]]; then
        print_error "This script must be run as root (use sudo)"
        print_info "Usage: sudo ./master_setup.sh"
        exit 1
    fi
}

confirm_action() {
    read -p "$(echo -e ${YELLOW}$1 [y/N]:${NC} )" -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        return 1
    fi
    return 0
}

####
# PRE-FLIGHT CHECKS - COMPREHENSIVE VALIDATION
####

run_preflight_checks() {
    print_header "PRE-FLIGHT CHECKS - System Validation"
    
    check_root
    
    local preflight_passed=true
    
    # Check 1: Operating System Verification
    print_section "Operating System Verification"
    if grep -q "Kali" /etc/os-release 2>/dev/null; then
        print_success "Running on Kali Linux"
        
        # Check if Kali Purple specifically
        if dpkg -l | grep -q "kali-linux-purple" 2>/dev/null; then
            print_success "Kali Purple detected (defensive security tools included)"
        else
            print_warning "Standard Kali detected (not Kali Purple)"
            print_info "Consider installing: apt install kali-linux-purple"
        fi
    else
        print_error "Not running on Kali Linux"
        print_warning "This platform is optimized for Kali Purple Linux"
        if ! confirm_action "Continue anyway?"; then
            exit 0
        fi
        preflight_passed=false
    fi
    
    # Check 2: Internet Connectivity
    print_section "Network Connectivity"
    if ping -c 1 -W 2 8.8.8.8 &> /dev/null; then
        print_success "Internet connectivity confirmed"
    else
        print_error "No internet connectivity"
        print_warning "Some installation steps may fail without internet"
        if ! confirm_action "Continue anyway?"; then
            exit 1
        fi
        preflight_passed=false
    fi
    
    # Check 3: Disk Space
    print_section "Disk Space Requirements"
    local available_gb=$(df / | tail -1 | awk '{printf "%.1f", $4/1024/1024}')
    local available_kb=$(df / | tail -1 | awk '{print $4}')
    
    print_info "Available disk space: ${available_gb}GB"
    
    if [ "$available_kb" -lt 20000 ]; then
        print_error "Less than 20GB free disk space available"
        print_warning "Minimum 20GB required. 50GB+ recommended"
        if ! confirm_action "Continue anyway?"; then
            exit 0
        fi
        preflight_passed=false
    elif [ "$available_kb" -lt 50000 ]; then
        print_warning "Less than 50GB free (${available_gb}GB available)"
        print_info "Recommend 50GB+ for optimal operation"
    else
        print_success "Sufficient disk space: ${available_gb}GB available"
    fi
    
    # Check 4: Memory (RAM)
    print_section "Memory (RAM)"
    local total_ram_gb=$(free -g | awk '/^Mem:/{print $2}')
    print_info "Total RAM: ${total_ram_gb}GB"
    
    if [ "$total_ram_gb" -lt 8 ]; then
        print_warning "Less than 8GB RAM detected"
        print_info "8GB minimum, 16GB+ recommended for optimal performance"
    elif [ "$total_ram_gb" -lt 16 ]; then
        print_info "RAM adequate (${total_ram_gb}GB). 16GB+ recommended for heavy scans"
    else
        print_success "RAM excellent: ${total_ram_gb}GB"
    fi
    
    # Check 5: CPU Cores
    print_section "CPU Information"
    local cpu_cores=$(nproc)
    print_info "CPU cores available: $cpu_cores"
    
    if [ "$cpu_cores" -lt 4 ]; then
        print_warning "Less than 4 CPU cores detected"
        print_info "4+ cores recommended for parallel scanning"
    else
        print_success "CPU cores adequate: $cpu_cores"
    fi
    
    # Check 6: Python Version
    print_section "Python Version Check"
    if command -v python3 &> /dev/null; then
        local python_version=$(python3 --version 2>&1 | awk '{print $2}')
        local python_major=$(echo $python_version | cut -d. -f1)
        local python_minor=$(echo $python_version | cut -d. -f2)
        
        print_info "Python version: $python_version"
        
        if [ "$python_major" -eq 3 ] && [ "$python_minor" -ge 10 ]; then
            print_success "Python 3.$python_minor detected (compatible)"
        elif [ "$python_major" -eq 3 ] && [ "$python_minor" -ge 8 ]; then
            print_warning "Python 3.$python_minor detected (minimum compatible)"
            print_info "Python 3.10+ recommended"
        else
            print_error "Python 3.10+ required (found: $python_version)"
            preflight_passed=false
        fi
    else
        print_error "Python 3 not found"
        print_warning "Python 3.10+ is required"
        preflight_passed=false
    fi
    
    # Check 7: Git (for tool downloads)
    print_section "Git Availability"
    if command -v git &> /dev/null; then
        print_success "Git installed"
    else
        print_warning "Git not found (needed for some tool installations)"
        print_info "Install with: apt install git"
    fi
    
    # Check 8: Essential Tools
    print_section "Essential Command-Line Tools"
    local essential_tools=("curl" "wget" "nmap" "netcat" "python3-pip")
    local missing_tools=()
    
    for tool in "${essential_tools[@]}"; do
        if command -v $tool &> /dev/null || dpkg -l | grep -q "^ii.*$tool" 2>/dev/null; then
            print_success "$tool found"
        else
            print_warning "$tool not found"
            missing_tools+=("$tool")
        fi
    done
    
    if [ ${#missing_tools[@]} -gt 0 ]; then
        print_info "Missing tools will be installed: ${missing_tools[*]}"
    fi
    
    # Summary
    print_section "Pre-flight Check Summary"
    if [ "$preflight_passed" = true ] && [ ${#missing_tools[@]} -eq 0 ]; then
        print_success "All critical checks passed"
        echo ""
    else
        print_warning "Some checks failed or tools are missing"
        print_info "Installation will attempt to resolve issues automatically"
        echo ""
        if ! confirm_action "Continue with installation?"; then
            exit 0
        fi
    fi
}

####
# DIRECTORY STRUCTURE CREATION
####

create_directory_structure() {
    print_header "DIRECTORY STRUCTURE CREATION"
    
    print_section "Creating System Directories (/opt/purple-team)"
    
    # System directories
    local system_dirs=(
        "$SYSTEM_INSTALL_DIR"
        "$SYSTEM_INSTALL_DIR/scanners"
        "$SYSTEM_INSTALL_DIR/utilities"
        "$SYSTEM_INSTALL_DIR/utils"
        "$SYSTEM_INSTALL_DIR/config"
        "$SYSTEM_INSTALL_DIR/docs"
        "$SYSTEM_INSTALL_DIR/results"
        "$SYSTEM_INSTALL_DIR/logs"
        "$SYSTEM_INSTALL_DIR/tools"
    )
    
    for dir in "${system_dirs[@]}"; do
        if [ -d "$dir" ]; then
            print_info "Exists: $dir"
        else
            mkdir -p "$dir"
            print_success "Created: $dir"
        fi
    done
    
    print_section "Creating User Directories (~/.purple-team)"
    
    # User directories
    local user_dirs=(
        "$USER_INSTALL_DIR"
        "$USER_INSTALL_DIR/config"
        "$USER_INSTALL_DIR/results"
        "$USER_INSTALL_DIR/logs"
        "$USER_INSTALL_DIR/venv"
    )
    
    for dir in "${user_dirs[@]}"; do
        if [ -d "$dir" ]; then
            print_info "Exists: $dir"
        else
            mkdir -p "$dir"
            chown "$ACTUAL_USER:$ACTUAL_USER" "$dir"
            print_success "Created: $dir"
        fi
    done
    
    print_success "Directory structure created"
}

####
# SYSTEM UPDATE
####

update_system() {
    print_header "SYSTEM UPDATE"
    
    print_section "Updating Package Lists"
    
    if confirm_action "Run apt update?"; then
        print_info "Updating apt repositories..."
        apt update || {
            print_warning "apt update encountered issues (continuing)"
        }
        print_success "Package lists updated"
    else
        print_info "Skipping apt update"
    fi
    
    print_section "Checking for Upgradable Packages"
    local upgradable=$(apt list --upgradable 2>/dev/null | grep -c "upgradable" || echo "0")
    
    if [ "$upgradable" -gt 0 ]; then
        print_info "Found $upgradable upgradable packages"
        
        if confirm_action "Upgrade system packages?"; then
            print_info "Running apt upgrade (this may take several minutes)..."
            apt upgrade -y || {
                print_warning "apt upgrade encountered issues (continuing)"
            }
            print_success "System packages upgraded"
        else
            print_info "Skipping package upgrade"
        fi
    else
        print_success "System is up to date"
    fi
}

####
# SECURITY TOOLS INSTALLATION
####

install_security_tools() {
    print_header "SECURITY TOOLS INSTALLATION"
    
    print_section "Installing Essential Tools"
    
    local essential_packages=(
        "nmap"
        "masscan"
        "nikto"
        "sqlmap"
        "metasploit-framework"
        "hydra"
        "john"
        "hashcat"
        "aircrack-ng"
        "wireshark"
        "tcpdump"
        "netcat-traditional"
        "curl"
        "wget"
        "git"
        "python3-pip"
        "python3-venv"
        "jq"
    )
    
    print_info "Installing ${#essential_packages[@]} essential packages..."
    
    for package in "${essential_packages[@]}"; do
        if dpkg -l | grep -q "^ii.*$package" 2>/dev/null; then
            print_success "$package already installed"
        else
            print_info "Installing $package..."
            apt install -y "$package" 2>/dev/null || {
                print_warning "Failed to install $package (continuing)"
            }
        fi
    done
    
    print_section "Installing Kali Purple Tools (if available)"
    
    if ! dpkg -l | grep -q "kali-linux-purple" 2>/dev/null; then
        if confirm_action "Install kali-linux-purple metapackage?"; then
            print_info "Installing Kali Purple tools (this will take 10-30 minutes)..."
            apt install -y kali-linux-purple || {
                print_warning "Failed to install kali-linux-purple (continuing)"
            }
            print_success "Kali Purple tools installed"
        else
            print_info "Skipping Kali Purple metapackage"
        fi
    else
        print_success "Kali Purple tools already installed"
    fi
    
    print_success "Security tools installation complete"
}

####
# PYTHON ENVIRONMENT SETUP
####

setup_python_environment() {
    print_header "PYTHON ENVIRONMENT SETUP"
    
    print_section "Creating Virtual Environment"
    
    # System virtual environment
    if [ ! -d "$SYSTEM_INSTALL_DIR/venv" ]; then
        print_info "Creating system virtual environment..."
        python3 -m venv "$SYSTEM_INSTALL_DIR/venv"
        print_success "System venv created: $SYSTEM_INSTALL_DIR/venv"
    else
        print_info "System venv already exists"
    fi
    
    # User virtual environment
    if [ ! -d "$USER_INSTALL_DIR/venv" ]; then
        print_info "Creating user virtual environment..."
        sudo -u "$ACTUAL_USER" python3 -m venv "$USER_INSTALL_DIR/venv"
        chown -R "$ACTUAL_USER:$ACTUAL_USER" "$USER_INSTALL_DIR/venv"
        print_success "User venv created: $USER_INSTALL_DIR/venv"
    else
        print_info "User venv already exists"
    fi
    
    print_section "Installing Python Dependencies"
    
    # Check if requirements.txt exists
    if [ -f "$SCRIPT_DIR/requirements.txt" ]; then
        print_info "Found requirements.txt, installing dependencies..."
        
        # Install to system venv
        source "$SYSTEM_INSTALL_DIR/venv/bin/activate"
        pip install --upgrade pip
        pip install -r "$SCRIPT_DIR/requirements.txt" || {
            print_warning "Some Python dependencies failed to install (continuing)"
        }
        deactivate
        
        # Install to user venv
        sudo -u "$ACTUAL_USER" bash -c "source $USER_INSTALL_DIR/venv/bin/activate &amp;&amp; pip install --upgrade pip &amp;&amp; pip install -r $SCRIPT_DIR/requirements.txt"
        
        print_success "Python dependencies installed"
    else
        print_warning "requirements.txt not found, skipping dependency installation"
        print_info "You can manually install dependencies later"
    fi
    
    print_success "Python environment setup complete"
}

####
# CONFIGURATION FILES
####

create_config_files() {
    print_header "CONFIGURATION FILES CREATION"
    
    print_section "Copying Configuration Templates"
    
    # Copy all config templates from script directory to system config directory
    if [ -d "$SCRIPT_DIR/config" ]; then
        print_info "Copying configuration templates..."
        cp -r "$SCRIPT_DIR/config/"* "$SYSTEM_INSTALL_DIR/config/" 2>/dev/null || {
            print_warning "No config templates found in $SCRIPT_DIR/config/"
        }
    fi
    
    # Copy individual config files if they exist
    local config_files=(
        "config-template.yaml"
        "config-healthcare.yaml"
        "config-finance.yaml"
        "config-retail.yaml"
        "config-government.yaml"
    )
    
    for config_file in "${config_files[@]}"; do
        if [ -f "$SCRIPT_DIR/$config_file" ]; then
            cp "$SCRIPT_DIR/$config_file" "$SYSTEM_INSTALL_DIR/config/"
            print_success "Copied: $config_file"
        fi
    done
    
    print_section "Creating User Configuration"
    
    # Create user config from template
    if [ -f "$SYSTEM_INSTALL_DIR/config/config-template.yaml" ]; then
        if [ ! -f "$USER_INSTALL_DIR/config.yaml" ]; then
            cp "$SYSTEM_INSTALL_DIR/config/config-template.yaml" "$USER_INSTALL_DIR/config.yaml"
            chown "$ACTUAL_USER:$ACTUAL_USER" "$USER_INSTALL_DIR/config.yaml"
            print_success "User config created: $USER_INSTALL_DIR/config.yaml"
            print_info "Edit this file to customize for your client"
        else
            print_info "User config already exists (preserving)"
        fi
    else
        print_warning "No config template found, creating minimal config..."
        cat > "$USER_INSTALL_DIR/config.yaml" &lt;&lt; 'EOFCONFIG'
# Purple Team GRC Platform - User Configuration
client:
  name: "CHANGEME"
  industry: "technology"

network:
  auto_detect: true
  ranges: []
  exclusions: []

scanning:
  stealth_level: 3
  max_rate: 100

results:
  output_dir: "~/.purple-team/results/"
  formats: ["json", "html", "csv"]
  retention_days: 90
EOFCONFIG
        chown "$ACTUAL_USER:$ACTUAL_USER" "$USER_INSTALL_DIR/config.yaml"
        print_success "Minimal config created"
    fi
    
    print_success "Configuration files ready"
}

####
# CORE SCRIPTS INSTALLATION
####

install_core_scripts() {
    print_header "CORE SCRIPTS INSTALLATION"
    
    print_section "Copying Scanner Scripts"
    
    # Copy scanners
    if [ -d "$SCRIPT_DIR/scanners" ]; then
        cp -r "$SCRIPT_DIR/scanners/"* "$SYSTEM_INSTALL_DIR/scanners/" 2>/dev/null
        print_success "Scanner scripts copied"
    else
        print_warning "No scanner directory found"
    fi
    
    # Copy utilities
    if [ -d "$SCRIPT_DIR/utilities" ]; then
        cp -r "$SCRIPT_DIR/utilities/"* "$SYSTEM_INSTALL_DIR/utilities/" 2>/dev/null
        print_success "Utility scripts copied"
    else
        print_warning "No utilities directory found"
    fi
    
    # Copy utils (infrastructure)
    if [ -d "$SCRIPT_DIR/utils" ]; then
        cp -r "$SCRIPT_DIR/utils/"* "$SYSTEM_INSTALL_DIR/utils/" 2>/dev/null
        print_success "Infrastructure scripts copied"
    else
        print_warning "No utils directory found"
    fi
    
    # Make scripts executable
    print_section "Setting Script Permissions"
    chmod +x "$SYSTEM_INSTALL_DIR/scanners/"*.py 2>/dev/null
    chmod +x "$SYSTEM_INSTALL_DIR/utilities/"*.py 2>/dev/null
    chmod +x "$SYSTEM_INSTALL_DIR/utils/"*.py 2>/dev/null
    chmod +x "$SYSTEM_INSTALL_DIR/utils/"*.sh 2>/dev/null
    print_success "Scripts made executable"
    
    # Copy documentation
    if [ -d "$SCRIPT_DIR/docs" ]; then
        cp -r "$SCRIPT_DIR/docs/"* "$SYSTEM_INSTALL_DIR/docs/" 2>/dev/null
        print_success "Documentation copied"
    fi
    
    # Copy other important files
    for file in README.md INSTALL.md CHANGELOG.md LICENSE; do
        if [ -f "$SCRIPT_DIR/$file" ]; then
            cp "$SCRIPT_DIR/$file" "$SYSTEM_INSTALL_DIR/"
            print_success "Copied: $file"
        fi
    done
    
    print_success "Core scripts installed"
}

####
# LAUNCHER INSTALLATION
####

install_launchers() {
    print_header "LAUNCHER INSTALLATION"
    
    print_section "Installing Terminal Launcher"
    
    if [ -f "$SCRIPT_DIR/purple-team-launcher" ] || [ -f "$SYSTEM_INSTALL_DIR/utils/purple-team-launcher" ]; then
        local launcher_source=""
        
        if [ -f "$SCRIPT_DIR/purple-team-launcher" ]; then
            launcher_source="$SCRIPT_DIR/purple-team-launcher"
        else
            launcher_source="$SYSTEM_INSTALL_DIR/utils/purple-team-launcher"
        fi
        
        cp "$launcher_source" /usr/local/bin/purple-team-launcher
        chmod +x /usr/local/bin/purple-team-launcher
        print_success "Terminal launcher installed: purple-team-launcher"
    else
        print_warning "Terminal launcher script not found"
    fi
    
    print_section "Installing Desktop GUI Launcher"
    
    if [ -f "$SCRIPT_DIR/purple-team-gui" ] || [ -f "$SYSTEM_INSTALL_DIR/utils/purple-team-gui" ]; then
        local gui_source=""
        
        if [ -f "$SCRIPT_DIR/purple-team-gui" ]; then
            gui_source="$SCRIPT_DIR/purple-team-gui"
        else
            gui_source="$SYSTEM_INSTALL_DIR/utils/purple-team-gui"
        fi
        
        cp "$gui_source" /usr/local/bin/purple-team-gui
        chmod +x /usr/local/bin/purple-team-gui
        print_success "GUI launcher installed: purple-team-gui"
    else
        print_warning "GUI launcher script not found"
    fi
    
    print_section "Installing Sync Manager"
    
    if [ -f "$SCRIPT_DIR/sync-manager.sh" ] || [ -f "$SYSTEM_INSTALL_DIR/utils/sync-manager.sh" ]; then
        local sync_source=""
        
        if [ -f "$SCRIPT_DIR/sync-manager.sh" ]; then
            sync_source="$SCRIPT_DIR/sync-manager.sh"
        else
            sync_source="$SYSTEM_INSTALL_DIR/utils/sync-manager.sh"
        fi
        
        cp "$sync_source" /usr/local/bin/purple-team-sync
        chmod +x /usr/local/bin/purple-team-sync
        print_success "Sync manager installed: purple-team-sync"
    else
        print_warning "Sync manager script not found"
    fi
    
    print_success "Launchers installed"
}

####
# SYSTEMD SERVICES (OPTIONAL)
####

setup_systemd_services() {
    print_header "SYSTEMD SERVICES SETUP"
    
    print_section "Creating Systemd Service Files"
    
    if confirm_action "Setup systemd services for automatic monitoring?"; then
        # This is optional and can be expanded later
        print_info "Systemd service setup not yet implemented"
        print_info "Services can be added in future versions"
    else
        print_info "Skipping systemd service setup"
    fi
    
    print_success "Systemd configuration complete"
}

####
# SYNC MANAGER SETUP
####

setup_sync_manager() {
    print_header "SYNC MANAGER CONFIGURATION"
    
    print_section "Configuring Automatic Synchronization"
    
    # Run initial sync
    if [ -f "$SYSTEM_INSTALL_DIR/utils/sync-manager.sh" ]; then
        print_info "Running initial sync between /opt and ~/.purple-team..."
        bash "$SYSTEM_INSTALL_DIR/utils/sync-manager.sh" || {
            print_warning "Initial sync encountered issues (continuing)"
        }
        print_success "Initial sync complete"
    else
        print_warning "Sync manager not found (skipping sync setup)"
        return 0
    fi
    
    # Create sync cron job (optional)
    if confirm_action "Setup automatic sync via cron? (Runs hourly)"; then
        print_info "Adding cron job for sync..."
        
        # Add to root crontab
        (crontab -l 2>/dev/null; echo "0 * * * * $SYSTEM_INSTALL_DIR/utils/sync-manager.sh >/dev/null 2>&1") | crontab -
        
        print_success "Sync cron job added (runs hourly)"
        print_info "View with: crontab -l"
    else
        print_info "Manual sync available via: purple-team-sync"
    fi
    
    print_success "Sync manager configured"
}

####
# FINAL SETUP & PERMISSIONS
####

final_setup() {
    print_header "FINAL SETUP & PERMISSIONS"
    
    print_section "Setting Ownership & Permissions"
    
    # System directory permissions
    chown -R root:root "$SYSTEM_INSTALL_DIR"
    chmod 755 "$SYSTEM_INSTALL_DIR"
    chmod -R 755 "$SYSTEM_INSTALL_DIR/scanners" 2>/dev/null
    chmod -R 755 "$SYSTEM_INSTALL_DIR/utils" 2>/dev/null
    chmod -R 775 "$SYSTEM_INSTALL_DIR/results" 2>/dev/null
    chmod -R 775 "$SYSTEM_INSTALL_DIR/logs" 2>/dev/null
    
    # User directory permissions
    chown -R "$ACTUAL_USER:$ACTUAL_USER" "$ACTUAL_HOME/.purple-team"
    chmod 755 "$ACTUAL_HOME/.purple-team"
    chmod -R 755 "$ACTUAL_HOME/.purple-team/config" 2>/dev/null
    chmod -R 775 "$ACTUAL_HOME/.purple-team/results" 2>/dev/null
    chmod -R 775 "$ACTUAL_HOME/.purple-team/logs" 2>/dev/null
    
    print_success "Permissions configured"
    
    # Create version file
    print_section "Recording Installation Version"
    echo "$VERSION" > "$SYSTEM_INSTALL_DIR/VERSION"
    echo "$(date -u +"%Y-%m-%d %H:%M:%S UTC")" > "$SYSTEM_INSTALL_DIR/INSTALL_DATE"
    print_success "Version: $VERSION"
    
    # Create README in user directory
    cat > "$ACTUAL_HOME/.purple-team/README.txt" &lt;&lt; 'EOFREADME'
Purple Team GRC Platform v3.0
====

This directory contains your per-user configuration and results.

Important Files:
- config.yaml: Your client-specific configuration
- results/: Scan results and reports
- logs/: Your scan logs
- venv/: Your Python virtual environment

Quick Start:
1. Edit config.yaml with your client settings
2. Run: purple-team-launcher (terminal menu)
3. Or run: purple-team-gui (desktop interface)

Documentation:
- System-wide: /opt/purple-team/docs/
- Deployment Guide: See project documentation

Support:
- Run pre-flight check: /opt/purple-team/utils/pre-flight-checker.py
- Sync with system: purple-team-sync
- View logs: ~/.purple-team/logs/

Version: 3.0
EOFREADME
    
    chown "$ACTUAL_USER:$ACTUAL_USER" "$ACTUAL_HOME/.purple-team/README.txt"
    print_success "User README created"
    
    print_success "Final setup complete"
}

####
# INSTALLATION SUMMARY
####

print_installation_summary() {
    print_header "INSTALLATION COMPLETE"
    
    echo ""
    echo -e "${GREEN}┌────┐${NC}"
    echo -e "${GREEN}│                    │${NC}"
    echo -e "${GREEN}│        Purple Team GRC Platform v3.0 Installed Successfully      │${NC}"
    echo -e "${GREEN}│                    │${NC}"
    echo -e "${GREEN}└────┘${NC}"
    echo ""
    
    print_section "Installation Locations"
    echo "  System-wide:  $SYSTEM_INSTALL_DIR"
    echo "  Per-user:     $ACTUAL_HOME/.purple-team"
    echo "  System logs:  $SYSTEM_LOG_DIR"
    echo ""
    
    print_section "Quick Start Commands"
    echo "  Launch terminal menu:    ${CYAN}purple-team-launcher${NC}"
    echo "  Launch GUI:              ${CYAN}purple-team-gui${NC}"
    echo "  Sync installations:      ${CYAN}purple-team-sync${NC}"
    echo "  Run pre-flight check:    ${CYAN}$SYSTEM_INSTALL_DIR/utils/pre-flight-checker.py${NC}"
    echo ""
    
    print_section "Next Steps"
    echo "  1. Edit configuration:   ${YELLOW}vim $ACTUAL_HOME/.purple-team/config.yaml${NC}"
    echo "  2. Set network ranges and client information"
    echo "  3. Run pre-flight check to validate installation"
    echo "  4. Launch platform:      ${CYAN}purple-team-launcher${NC}"
    echo "  5. Review documentation in $SYSTEM_INSTALL_DIR/docs/"
    echo ""
    
    print_section "Important Notes"
    echo "  • Configuration file: $ACTUAL_HOME/.purple-team/config.yaml"
    echo "  • Scan results: $ACTUAL_HOME/.purple-team/results/"
    echo "  • User logs: $ACTUAL_HOME/.purple-team/logs/"
    echo "  • System-wide settings: $SYSTEM_INSTALL_DIR/config/config.yaml (template)"
    echo ""
    
    if [ -f /usr/local/bin/purple-team-launcher ]; then
        print_warning "READY TO USE: Run 'purple-team-launcher' to begin!"
    else
        print_warning "Launchers not found. Manual launch: source venv and run scripts directly"
    fi
    
    echo ""
    print_success "Installation log: $SETUP_LOG"
    echo ""
}

####
# MAIN EXECUTION
####

main() {
    clear
    
    echo ""
    echo -e "${BLUE}┌────┐${NC}"
    echo -e "${BLUE}│           Purple Team GRC Platform - Master Setup v3.0           │${NC}"
    echo -e "${BLUE}│  Production-Ready Security Assessment & Compliance Platform      │${NC}"
    echo -e "${BLUE}└────┘${NC}"
    echo ""
    echo "This script will:"
    echo "  • Validate system requirements (pre-flight checks)"
    echo "  • Install security tools and dependencies"
    echo "  • Setup dual installation (system-wide + per-user)"
    echo "  • Configure Python environments"
    echo "  • Install launchers and sync manager"
    echo "  • Create configuration files"
    echo ""
    echo "Estimated time: 10-20 minutes"
    echo ""
    
    if ! confirm_action "Proceed with installation?"; then
        echo ""
        print_info "Installation cancelled by user"
        exit 0
    fi
    
    # Execute installation phases
    run_preflight_checks
    create_directory_structure
    update_system
    install_security_tools
    setup_python_environment
    create_config_files
    install_core_scripts
    install_launchers
    setup_systemd_services
    setup_sync_manager
    final_setup
    print_installation_summary
    
    echo ""
    print_success "Setup complete! Ready for deployment."
    echo ""
}

# Execute main function
main "$@"

####
# END OF SCRIPT
####</code></pre>
            </section>

            <!-- APPENDIX B – PYTHON SCRIPTS LIST -->
            <section id="appendix-b-python-scripts">
                <h2>Appendix B – Python Scripts Overview (23 Files)</h2>
                <p>
                    The platform includes 23 core Python modules grouped into scanners and utilities. All scripts use
                    <span class="mono">utils/path_helper.py</span> for dynamic paths and support both system‑wide
                    and per‑user installations.
                </p>

                <h3>B.1 Scanner Modules (11 files)</h3>
                <table>
                    <tr><th>Script</th><th>Purpose</th></tr>
                    <tr><td><span class="mono">network_scanner.py</span></td><td>Stealthy network discovery and port scanning.</td></tr>
                    <tr><td><span class="mono">vulnerability_scanner.py</span></td><td>Comprehensive vulnerability assessment using multiple tools.</td></tr>
                    <tr><td><span class="mono">compliance_checker.py</span></td><td>Maps findings to frameworks (SOC 2, NIST, ISO, HIPAA, SOX, etc.).</td></tr>
                    <tr><td><span class="mono">integrated_grc_scanner.py</span></td><td>End‑to‑end scan pipeline integrating evidence and risk scoring.</td></tr>
                    <tr><td><span class="mono">quick_scan.py</span></td><td>Fast targeted scans for quick checks before/after changes.</td></tr>
                    <tr><td><span class="mono">exploit_validator.py</span></td><td>Non‑destructive proof‑of‑concept validation of vulnerabilities.</td></tr>
                    <tr><td><span class="mono">risk_scorer.py</span></td><td>Calculates composite risk scores (CVSS + business impact + likelihood).</td></tr>
                    <tr><td><span class="mono">finding_deduplicator.py</span></td><td>De‑duplicates findings and merges duplicates with history.</td></tr>
                    <tr><td><span class="mono">evidence_manager.py</span></td><td>Centralized evidence repository with control citations and chain of custody.</td></tr>
                    <tr><td><span class="mono">executive_report_generator.py</span></td><td>Generates one‑page executive summaries.</td></tr>
                    <tr><td><span class="mono">questionnaire_responder.py</span></td><td>Auto‑fills security questionnaires (VSA, SIG, CAIQ) with evidence links.</td></tr>
                </table>

                <h3>B.2 Utility Modules (12 files)</h3>
                <table>
                    <tr><th>Script</th><th>Purpose</th></tr>
                    <tr><td><span class="mono">report_emailer.py</span></td><td>Sends reports and summaries via email with attachments.</td></tr>
                    <tr><td><span class="mono">config_change_detector.py</span></td><td>Detects configuration drift from baselines.</td></tr>
                    <tr><td><span class="mono">port_change_detector.py</span></td><td>Monitors for unexpected open/closed ports on hosts.</td></tr>
                    <tr><td><span class="mono">patch_status_checker.py</span></td><td>Assesses OS and application patch levels.</td></tr>
                    <tr><td><span class="mono">service_availability_monitor.py</span></td><td>Tracks uptime for critical HTTP services and ports.</td></tr>
                    <tr><td><span class="mono">health_check_monitor.py</span></td><td>Monitors platform health (logs, DBs, scheduled tasks).</td></tr>
                    <tr><td><span class="mono">cert_expiration_monitor.py</span></td><td>Tracks SSL/TLS certificate expiration.</td></tr>
                    <tr><td><span class="mono">asset_inventory_tracker.py</span></td><td>Maintains an asset inventory database from discovery runs.</td></tr>
                    <tr><td><span class="mono">backup_restore.py</span></td><td>Backs up and restores platform data and configuration.</td></tr>
                    <tr><td><span class="mono">zero_config_discovery.py</span></td><td>Zero‑configuration discovery suitable for any industry.</td></tr>
                    <tr><td><span class="mono">scheduler.py</span></td><td>Runs scheduled scans and tasks based on <span class="mono">config.yaml</span>.</td></tr>
                    <tr><td><span class="mono">dashboard_app.py</span></td><td>Flask web dashboard for visualizing results and initiating scans.</td></tr>
                </table>
            </section>

            <!-- APPENDIX C – CONFIG TEMPLATES FULL YAML -->
            <section id="appendix-c-config-templates">
                <h2>Appendix C – Configuration Templates (Full YAML)</h2>
                <p>
                    The following sections contain the complete YAML configuration templates for all five supported
                    industry profiles and the generic template. These are the same files installed under
                    <span class="mono">/opt/purple-team/config/</span>.
                </p>

                <h3>C.1 Generic Template – <span class="mono">config-template.yaml</span></h3>
                <pre><code class="language-yaml"># Purple Team GRC Platform Configuration
# Version: 3.0
# Industry: General/Technology
# Auto-generated: 2026-01-01

# ====
# CLIENT INFORMATION
# ====
client:
  name: "Client Name Here"
  industry: "technology"  # healthcare, finance, retail, government, technology
  engagement_type: "audit"  # audit, pentest, compliance, assessment
  engagement_date: "2026-01-01"
  consultant: "Consultant Name"
  contact_email: "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="50333c39353e24103528313d203c357e333f3d">[email&#160;protected]</a>"

# ====
# NETWORK CONFIGURATION
# ====
network:
  # Auto-detection (recommended - let platform detect network ranges)
  auto_detect: true  # Set to false for manual configuration
  
  # Manual network ranges (populated by network-detector.py or manually)
  # Leave empty if auto_detect is true
  ranges: []
    # Examples (auto-detected or manually added):
    # - "10.50.0.0/16"
    # - "192.168.10.0/24"
    # - "172.16.0.0/12"
  
  # Exclusions (never scan these hosts - critical infrastructure)
  exclusions: []
    # Examples:
    # - "10.50.0.1"      # Gateway
    # - "10.50.0.10"     # Domain Controller
    # - "192.168.10.1"   # Firewall
    # - "192.168.10.5"   # Production Database Server
  
  # DNS servers for name resolution
  dns_servers:
    - "8.8.8.8"     # Google DNS
    - "1.1.1.1"     # Cloudflare DNS
  
  # Interface preferences
  prefer_wired: true  # Prefer wired (eth0) over wireless (wlan0) if both active
  scan_all_interfaces: true  # Scan all active interfaces (prompt user if multiple)

# ====
# COMPLIANCE FRAMEWORKS
# ====
compliance:
  # Select applicable frameworks
  frameworks:
    - "SOC2"      # SOC 2 Type II
    - "NIST"      # NIST Cybersecurity Framework
    - "ISO27001"  # ISO/IEC 27001
    # Add industry-specific frameworks as needed:
    # - "HIPAA"        # Healthcare
    # - "PCI-DSS"      # Payment cards
    # - "SOX"          # Financial reporting
    # - "FedRAMP"      # Government cloud
  
  # Evidence collection settings
  evidence:
    collect_screenshots: true   # Capture visual evidence
    collect_logs: true          # Collect relevant log files
    collect_configs: true       # Capture configuration files
    retention_days: 365         # Audit trail retention (1 year minimum)
    auto_organize: true         # Organize evidence by framework

# ====
# SCANNING CONFIGURATION
# ====
scanning:
  # Stealth settings (1 = maximum stealth/slowest, 5 = aggressive/fastest)
  # Level 1: Ultra-stealth (5min delay, T0 timing)
  # Level 2: High stealth (3min delay, T1 timing)
  # Level 3: Balanced (30sec delay, T2 timing) ★ RECOMMENDED
  # Level 4: Fast (10sec delay, T3 timing)
  # Level 5: Maximum speed (no delay, T4 timing)
  stealth_level: 3
  
  # Maximum scan rate (packets per second)
  max_rate: 100  # Reduce to 50 for more stealth, increase to 300 for speed
  
  # Random delay between scans (seconds)
  random_delay_min: 30    # Minimum wait between scans
  random_delay_max: 300   # Maximum wait between scans
  
  # Nmap timing template (T0=paranoid to T5=insane)
  # T0: Paranoid (300sec delay between probes)
  # T1: Sneaky (15sec delay)
  # T2: Polite (0.4sec delay) ★ RECOMMENDED
  # T3: Normal (default)
  # T4: Aggressive (fast)
  # T5: Insane (very fast, may miss results)
  timing_template: "T2"
  
  # Thread limits (concurrent operations)
  max_threads: 10  # Reduce for stealth, increase for speed
  
  # Port scan profiles
  port_profiles:
    quick: "21,22,23,80,443"  # Minimal essential ports
    common: "21,22,23,25,53,80,110,135,139,143,443,445,993,995,1433,3306,3389,5900,8080,8443"
    top100: "--top-ports 100"   # Nmap's top 100 ports
    top1000: "--top-ports 1000" # Nmap's top 1000 ports
    all: "-p-"  # All 65535 ports (very slow!)
  
  # Default port profile for scans
  default_ports: "common"  # Use 'common' for most engagements
  
  # Service version detection
  version_detection: true  # Detect service versions (more accurate)
  
  # OS fingerprinting
  os_detection: false  # Disable by default (requires root, more intrusive)

# ====
# SCHEDULING (Automated Scans)
# ====
schedule:
  # Vulnerability scans
  vulnerability_scan:
    enabled: true
    day: "Monday"      # Day of week
    time: "02:00"      # 24-hour format (2:00 AM)
    notify: true       # Send email notification on completion
  
  # Network discovery scans
  network_scan:
    enabled: true
    day: "Wednesday"
    time: "02:00"
    notify: true
  
  # Compliance validation checks
  compliance_check:
    enabled: true
    day: "Friday"
    time: "02:00"
    notify: true
  
  # Daily health checks
  health_check:
    enabled: true
    frequency: "daily"  # daily, weekly, hourly
    time: "06:00"       # 6:00 AM
    notify_on_failure: true  # Only notify if issues detected

# ====
# RESULTS & REPORTING
# ====
results:
  # Output directory (auto-detected based on user installation)
  # Do not modify unless you have specific requirements
  output_dir: "~/.purple-team/results/"
  
  # Retention policy
  retention_days: 90      # Archive results after 90 days
  auto_archive: true      # Automatically compress old results
  archive_location: "~/.purple-team/results/archived/"
  
  # Output formats (select all that apply)
  formats:
    - "json"    # Machine-readable (for automation)
    - "html"    # Human-readable web reports
    - "csv"     # Spreadsheet format (Excel/analysis)
    - "pdf"     # Executive summary reports
  
  # Report branding/customization
  branding:
    company_name: "Your Security Consulting Firm"
    logo_path: ""  # Path to logo image (optional, e.g., /opt/purple-team/assets/logo.png)
    footer_text: "Confidential - Client Privileged"
    
  # Executive report settings
  executive_reports:
    include_charts: true
    include_recommendations: true
    risk_matrix: true

# ====
# DASHBOARD (Web Interface)
# ====
dashboard:
  host: "127.0.0.1"  # Localhost only for security (do not expose externally!)
  port: 5000         # Default Flask port
  debug: false       # Never enable in production
  
  # Authentication (strongly recommended)
  auth_enabled: true
  username: "admin"
  password_hash: ""  # Auto-generated during installation (do not edit manually)
  
  # Session timeout (minutes)
  session_timeout: 30

# ====
# LOGGING
# ====
logging:
  # Log level: DEBUG (verbose), INFO (standard), WARNING, ERROR, CRITICAL
  level: "INFO"
  
  # Log file rotation
  max_size_mb: 100      # Rotate logs at 100MB
  backup_count: 10      # Keep 10 backup log files
  
  # Dual logging locations (automatic)
  user_logs: "~/.purple-team/logs/"                 # User-specific logs
  system_logs: "/var/log/purple-team/{username}/"   # System-wide audit trail (requires sudo)
  
  # Log rotation schedule
  rotate_daily: true
  
  # Log format
  include_timestamp: true
  include_level: true
  include_source: true  # Include script name in logs

# ====
# EMAIL NOTIFICATIONS
# ====
email:
  enabled: false  # Enable for automated email reports
  
  # SMTP configuration
  smtp_server: "smtp.gmail.com"
  smtp_port: 587
  use_tls: true
  
  # Authentication (use app passwords, not account passwords!)
  username: ""  # <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cbb2a4beb9e6aea6aaa2a78baca6aaa2a7e5a8a4a6">[email&#160;protected]</a>
  password: ""  # Gmail app password (not your account password)
  
  # Sender/recipient
  from_address: ""     # <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2655434842435466435e474b564a430845494b">[email&#160;protected]</a>
  to_addresses: []     # ["<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="374552545e475e5259430677524f565a475b521954585a">[email&#160;protected]</a>", "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a7d5c2c4ced7cec2c9d395e7c2dfc6cad7cbc289c4c8ca">[email&#160;protected]</a>"]
  
  # Email content
  subject_prefix: "[Purple Team]"
  include_summary: true
  include_full_report: false  # Attach full report (large files!)

# ====
# EXPLOIT VALIDATION (⚠ ONLY USE IN ISOLATED TEST ENVIRONMENTS!)
# ====
exploit_validation:
  enabled: false  # ⚠ Only enable in controlled lab environments
  
  # Test credentials (⚠ WARNING: Only use in isolated test labs!)
  # NEVER use real credentials or enable this in production environments
  test_credentials: []
    # Example (DO NOT USE REAL CREDENTIALS):
    # - {username: "testuser", password: "testpass", protocol: "ssh"}
    # - {username: "admin", password: "admin123", protocol: "smb"}
  
  # Exploit database update
  auto_update_exploits: true
  exploit_db_path: "/opt/purple-team/exploit-db/"

# ====
# INTEGRATION SETTINGS (SOC Tool Integration)
# ====
integrations:
  # TheHive (Incident Response Platform)
  thehive:
    enabled: false
    url: "http://localhost:9000"
    api_key: ""
    organization: "default"
    auto_create_cases: false  # Automatically create cases for critical findings
  
  # Wazuh (SIEM)
  wazuh:
    enabled: false
    url: "http://localhost:55000"
    username: ""
    password: ""
    auto_import_alerts: false
  
  # Suricata (IDS/IPS)
  suricata:
    enabled: false
    eve_log_path: "/var/log/suricata/eve.json"
    import_alerts: false
  
  # Zeek (Network Analysis)
  zeek:
    enabled: false
    log_directory: "/var/log/zeek/"
    import_logs: false
  
  # Malcolm (Network Traffic Analysis)
  malcolm:
    enabled: false
    url: "http://localhost:9200"
    username: ""
    password: ""

# ====
# ADVANCED SETTINGS
# ====
advanced:
  # Python version management
  python_stable: "3.11"    # Known-good stable version
  python_latest: "3.12"    # Latest version (may have compatibility issues)
  prefer_stable: true      # Use stable by default, fallback from latest if issues
  
  # Virtual environment locations (auto-managed)
  venv_system: "/opt/purple-team/venv"
  venv_user: "~/.purple-team/venv"
  
  # Update behavior
  auto_update_check: true       # Check for updates on every launch
  auto_install_updates: false   # Prompt before installing (recommended)
  check_breaking_changes: true  # Analyze release notes for breaking changes
  
  # Performance tuning
  max_concurrent_scans: 3       # Maximum simultaneous scan jobs
  scan_timeout_minutes: 120     # Timeout for individual scans (2 hours)
  
  # Backup settings
  auto_backup: true
  backup_location: "/opt/purple-team-backups/"
  backup_retention_days: 30

# ====
# END OF CONFIGURATION
# ====
# For help with configuration options, see:
# - Documentation: /opt/purple-team/docs/
# - Deployment Guide: Purple_Team_Deployment_Guide_v3.html
# - Support: Review troubleshooting appendix in deployment guide</code></pre>

                <h3>C.2 Healthcare Template – <span class="mono">config-healthcare.yaml</span></h3>
                <pre><code class="language-yaml"># Purple Team GRC Platform Configuration
# Version: 3.0
# Industry: HEALTHCARE
# Compliance: HIPAA, FDA 21 CFR Part 11, HITECH, SOC 2
# Auto-generated: 2026-01-01

# ====
# CLIENT INFORMATION
# ====
client:
  name: "Healthcare Client Name"
  industry: "healthcare"
  engagement_type: "hipaa_audit"  # hipaa_audit, security_assessment, pentest
  engagement_date: "2026-01-01"
  consultant: "Consultant Name"
  contact_email: "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7606041f0017150f361e13171a021e15170413151a1f1318025815191b">[email&#160;protected]</a>"
  
  # Healthcare-specific information
  healthcare:
    entity_type: "covered_entity"  # covered_entity, business_associate, hybrid
    phi_in_scope: true
    patient_count: 0  # Approximate number of patient records
    regulated_systems: []  # List of systems containing ePHI

# ====
# NETWORK CONFIGURATION
# ====
network:
  auto_detect: true
  ranges: []
  exclusions: []
    # Common healthcare exclusions:
    # - "10.x.x.x"  # EHR/EMR systems (schedule separately)
    # - "10.x.x.x"  # PACS/imaging systems (schedule separately)
    # - "10.x.x.x"  # Medical devices (requires FDA consideration)
  
  dns_servers:
    - "8.8.8.8"
    - "1.1.1.1"
  
  prefer_wired: true
  scan_all_interfaces: true
  
  # Healthcare-specific network considerations
  healthcare_network:
    medical_device_network: false  # Separate medical device network present?
    guest_network_isolated: true   # Guest WiFi isolated from PHI network?
    iot_devices_present: true      # Medical IoT devices present?

# ====
# COMPLIANCE FRAMEWORKS (HEALTHCARE-SPECIFIC)
# ====
compliance:
  frameworks:
    - "HIPAA"          # Health Insurance Portability and Accountability Act
    - "HITECH"         # Health Information Technology for Economic and Clinical Health
    - "FDA_21CFR11"    # FDA 21 CFR Part 11 (if applicable)
    - "SOC2"           # SOC 2 Type II
    - "NIST"           # NIST Cybersecurity Framework
    - "ISO27001"       # ISO/IEC 27001
  
  # HIPAA-specific controls
  hipaa:
    security_rule:
      administrative_safeguards: true
      physical_safeguards: true
      technical_safeguards: true
    
    privacy_rule:
      minimum_necessary: true
      phi_authorization: true
      notice_of_privacy_practices: true
    
    breach_notification:
      enabled: true
      threshold_records: 500  # Notify HHS if breach affects 500+ individuals
  
  # Evidence collection (enhanced for healthcare audits)
  evidence:
    collect_screenshots: true
    collect_logs: true
    collect_configs: true
    retention_days: 2555  # 7 years (HIPAA requirement)
    
    # Healthcare-specific evidence
    phi_handling:
      redact_phi: true           # Automatically redact PHI from evidence
      encrypt_evidence: true     # Encrypt all collected evidence
      audit_access: true         # Audit all access to evidence files
    
    # Map evidence to HIPAA controls
    hipaa_mapping:
      automatic: true
      include_citations: true    # Include regulatory citations

# ====
# SCANNING CONFIGURATION (HEALTHCARE-OPTIMIZED)
# ====
scanning:
  # More conservative scanning for healthcare (avoid disrupting patient care)
  stealth_level: 2  # Higher stealth for healthcare environments
  max_rate: 50      # Lower rate to avoid network disruption
  
  random_delay_min: 60    # Longer delays
  random_delay_max: 600   # Up to 10 minutes between scans
  
  timing_template: "T1"   # Sneaky timing
  max_threads: 5          # Fewer concurrent operations
  
  port_profiles:
    quick: "22,80,443,3389"
    common: "22,80,135,139,443,445,1433,3306,3389,5432,5900,8080,8443"
    healthcare_specific: "22,80,443,1433,3306,3389,5432,7001,7002,8080,8443,9200,11112"  # EHR/PACS ports
    top100: "--top-ports 100"
    top1000: "--top-ports 1000"
    all: "-p-"
  
  default_ports: "healthcare_specific"
  
  version_detection: true
  os_detection: false  # Disabled by default (can disrupt medical devices)
  
  # Healthcare-specific scanning rules
  healthcare_scanning:
    avoid_medical_devices: true      # Skip known medical device IPs
    scheduled_maintenance_window: true  # Only scan during maintenance windows
    maintenance_windows:
      - day: "Sunday"
        start: "02:00"
        end: "06:00"
    
    # Medical device handling
    medical_devices:
      scan_enabled: false  # Require explicit approval
      require_vendor_approval: true
      document_approvals: true

# ====
# SCHEDULING (HEALTHCARE MAINTENANCE WINDOWS)
# ====
schedule:
  # All scans during low-traffic periods only
  vulnerability_scan:
    enabled: true
    day: "Sunday"      # Weekend only
    time: "02:00"      # Early morning
    notify: true
  
  network_scan:
    enabled: true
    day: "Sunday"
    time: "03:30"
    notify: true
  
  compliance_check:
    enabled: true
    day: "Saturday"    # Weekly HIPAA compliance validation
    time: "02:00"
    notify: true
  
  health_check:
    enabled: true
    frequency: "daily"
    time: "06:00"
    notify_on_failure: true
  
  # HIPAA-specific scheduled tasks
  hipaa_tasks:
    risk_assessment:
      enabled: true
      frequency: "annual"  # Annual HIPAA risk assessment
      next_due: "2027-01-01"
    
    security_awareness_review:
      enabled: true
      frequency: "annual"

# ====
# RESULTS & REPORTING (HIPAA-COMPLIANT)
# ====
results:
  output_dir: "~/.purple-team/results/"
  retention_days: 2555  # 7 years (HIPAA requirement)
  auto_archive: true
  archive_location: "~/.purple-team/results/archived/"
  
  formats:
    - "json"
    - "html"
    - "csv"
    - "pdf"
  
  branding:
    company_name: "Your Healthcare Security Consulting Firm"
    logo_path: ""
    footer_text: "Confidential - HIPAA Protected Health Information"
  
  executive_reports:
    include_charts: true
    include_recommendations: true
    risk_matrix: true
    
    # HIPAA-specific reporting
    hipaa_reporting:
      include_control_mapping: true
      include_gap_analysis: true
      include_remediation_plan: true
      cite_regulations: true  # Include regulatory citations (45 CFR §164.xxx)

# ====
# DASHBOARD
# ====
dashboard:
  host: "127.0.0.1"
  port: 5000
  debug: false
  auth_enabled: true
  username: "admin"
  password_hash: ""
  session_timeout: 15  # Shorter timeout for healthcare (15 minutes)

# ====
# LOGGING (HIPAA AUDIT TRAIL)
# ====
logging:
  level: "INFO"
  max_size_mb: 100
  backup_count: 50  # More backup logs for compliance
  
  user_logs: "~/.purple-team/logs/"
  system_logs: "/var/log/purple-team/{username}/"
  
  rotate_daily: true
  
  # HIPAA audit trail requirements
  hipaa_audit_trail:
    enabled: true
    log_all_access: true        # Log all access to PHI
    log_modifications: true     # Log all modifications
    tamper_detection: true      # Detect log tampering
    retention_days: 2555        # 7 years

# ====
# EMAIL NOTIFICATIONS
# ====
email:
  enabled: false
  smtp_server: "smtp.gmail.com"
  smtp_port: 587
  use_tls: true
  username: ""
  password: ""
  from_address: ""
  to_addresses: []
  subject_prefix: "[HIPAA Audit]"
  include_summary: true
  include_full_report: false
  
  # Encrypt all email attachments
  encrypt_attachments: true

# ====
# EXPLOIT VALIDATION (DISABLED FOR HEALTHCARE)
# ====
exploit_validation:
  enabled: false  # ⚠️ Typically disabled in healthcare environments
  test_credentials: []

# ====
# INTEGRATION SETTINGS
# ====
integrations:
  thehive:
    enabled: false
    url: "http://localhost:9000"
    api_key: ""
    organization: "healthcare"
    auto_create_cases: true  # Create incidents for HIPAA violations
  
  wazuh:
    enabled: false
    url: "http://localhost:55000"
    username: ""
    password: ""
    auto_import_alerts: true
  
  suricata:
    enabled: false
    eve_log_path: "/var/log/suricata/eve.json"
    import_alerts: true
  
  zeek:
    enabled: false
    log_directory: "/var/log/zeek/"
    import_logs: false

# ====
# ADVANCED SETTINGS
# ====
advanced:
  python_stable: "3.11"
  python_latest: "3.12"
  prefer_stable: true
  
  venv_system: "/opt/purple-team/venv"
  venv_user: "~/.purple-team/venv"
  
  auto_update_check: true
  auto_install_updates: false
  check_breaking_changes: true
  
  max_concurrent_scans: 2  # Reduced for healthcare
  scan_timeout_minutes: 180  # Longer timeout (3 hours)
  
  auto_backup: true
  backup_location: "/opt/purple-team-backups/"
  backup_retention_days: 90
  
  # Healthcare-specific advanced settings
  healthcare_advanced:
    phi_encryption:
      enabled: true
      algorithm: "AES-256"
      key_rotation_days: 90
    
    access_controls:
      require_2fa: true
      session_timeout_minutes: 15
      failed_login_lockout: 3

# ====
# HIPAA CONTROL MAPPING
# ====
# This section maps platform capabilities to HIPAA Security Rule requirements
hipaa_control_mapping:
  administrative_safeguards:
    security_management_process:
      - "Risk analysis: risk_scorer.py"
      - "Risk management: compliance_checker.py"
      - "Sanction policy: evidence_manager.py (audit trail)"
      - "Information system activity review: health_check_monitor.py"
    
    assigned_security_responsibility:
      - "Security Official designation: (manual process)"
    
    workforce_security:
      - "Authorization/supervision: (manual process)"
      - "Workforce clearance: (manual process)"
      - "Termination procedures: (manual process)"
    
    information_access_management:
      - "Access authorization: dashboard authentication"
      - "Access establishment/modification: (manual process)"
    
    security_awareness_training:
      - "Training: (manual process - track with questionnaire_responder.py)"
    
    security_incident_procedures:
      - "Response and reporting: evidence_manager.py + TheHive integration"
    
    contingency_plan:
      - "Data backup: backup_restore.py"
      - "Disaster recovery: backup_restore.py"
      - "Emergency mode: (manual process)"
    
    evaluation:
      - "Periodic evaluation: compliance_checker.py (scheduled)"
    
    business_associate_contracts:
      - "Written contract: (manual process - track with questionnaire_responder.py)"
  
  physical_safeguards:
    facility_access_controls:
      - "Facility security plan: (manual process)"
      - "Access control/validation: (manual process)"
    
    workstation_use:
      - "Workstation policies: (manual process - verify with compliance_checker.py)"
    
    workstation_security:
      - "Physical safeguards: (manual process - verify with compliance_checker.py)"
    
    device_and_media_controls:
      - "Disposal: (manual process)"
      - "Media re-use: (manual process)"
      - "Accountability: asset_inventory_tracker.py"
      - "Data backup/storage: backup_restore.py"
  
  technical_safeguards:
    access_control:
      - "Unique user identification: dashboard user management"
      - "Emergency access: (manual process)"
      - "Automatic logoff: dashboard session timeout"
      - "Encryption: (verify with compliance_checker.py)"
    
    audit_controls:
      - "Audit logging: All scripts log to dual locations"
      - "Log review: health_check_monitor.py"
    
    integrity:
      - "Mechanism to authenticate ePHI: (verify with compliance_checker.py)"
    
    person_or_entity_authentication:
      - "Authentication procedures: dashboard authentication"
    
    transmission_security:
      - "Integrity controls: (verify with network_scanner.py - TLS/SSL checks)"
      - "Encryption: (verify with compliance_checker.py - data in transit)"

# ====
# END OF HEALTHCARE CONFIGURATION
# ====</code></pre>

                <h3>C.3 Finance Template – <span class="mono">config-finance.yaml</span></h3>
                <pre><code class="language-yaml"># Purple Team GRC Platform Configuration
# Version: 3.0
# Industry: FINANCIAL SERVICES
# Compliance: SOX, PCI-DSS, GLBA, FFIEC, SOC 2
# Auto-generated: 2026-01-01

# ====
# CLIENT INFORMATION
# ====
client:
  name: "Financial Services Client Name"
  industry: "finance"
  engagement_type: "sox_audit"  # sox_audit, pci_assessment, security_assessment
  engagement_date: "2026-01-01"
  consultant: "Consultant Name"
  contact_email: "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8deee2e0fde1e4ece3eee8cdebe4e3ece3eee4ece1eee1e4e8e3f9a3eee2e0">[email&#160;protected]</a>"
  
  # Finance-specific information
  finance:
    entity_type: "publicly_traded"  # publicly_traded, private, credit_union, bank
    sox_scope: true  # Subject to Sarbanes-Oxley Act
    pci_scope: true  # Processes credit card payments
    pci_level: "Level 1"  # Level 1, 2, 3, or 4
    transaction_volume: 0  # Annual transaction volume
    regulated_systems: []  # List of ITGC-scoped systems

# ====
# NETWORK CONFIGURATION
# ====
network:
  auto_detect: true
  ranges: []
  exclusions: []
    # Common financial exclusions:
    # - "10.x.x.x"  # Core banking systems (schedule separately)
    # - "10.x.x.x"  # Payment processing (PCI cardholder data environment)
    # - "10.x.x.x"  # Trading platforms (schedule during market close)
  
  dns_servers:
    - "8.8.8.8"
    - "1.1.1.1"
  
  prefer_wired: true
  scan_all_interfaces: true
  
  # Finance-specific network considerations
  finance_network:
    pci_cde_network: false  # PCI Cardholder Data Environment present?
    trading_network: false  # Trading/market data network present?
    dmz_configuration: true  # DMZ for public-facing services?
    network_segmentation: true  # Segmentation between environments?

# ====
# COMPLIANCE FRAMEWORKS (FINANCE-SPECIFIC)
# ====
compliance:
  frameworks:
    - "SOX"           # Sarbanes-Oxley Act
    - "PCI-DSS"       # Payment Card Industry Data Security Standard
    - "GLBA"          # Gramm-Leach-Bliley Act
    - "FFIEC"         # Federal Financial Institutions Examination Council
    - "SOC2"          # SOC 2 Type II
    - "NIST"          # NIST Cybersecurity Framework
    - "ISO27001"      # ISO/IEC 27001
  
  # SOX-specific controls (IT General Controls)
  sox:
    itgc_controls:
      access_controls: true          # ITGC-01: Logical access controls
      change_management: true         # ITGC-02: Program change controls
      computer_operations: true       # ITGC-03: Computer operations
      segregation_of_duties: true     # ITGC-04: Segregation of duties
    
    financial_reporting_systems:
      erp_in_scope: true
      gl_in_scope: true
      sub_ledgers_in_scope: true
  
  # PCI-DSS specific controls
  pci_dss:
    version: "4.0"  # PCI-DSS version (3.2.1 or 4.0)
    
    requirements:
      req_1_firewall: true              # Install and maintain network security controls
      req_2_defaults: true              # Apply secure configurations
      req_3_protect_data: true          # Protect stored cardholder data
      req_4_encrypt_transmission: true  # Protect cardholder data in transit
      req_5_malware: true               # Protect systems from malicious software
      req_6_secure_systems: true        # Develop and maintain secure systems
      req_7_access_controls: true       # Restrict access by business need
      req_8_identify_users: true        # Identify users and authenticate access
      req_9_physical_access: true       # Restrict physical access
      req_10_log_access: true           # Log and monitor all access
      req_11_test_security: true        # Test security of systems regularly
      req_12_security_policy: true      # Support information security
    
    cardholder_data_environment:
      in_scope: true
      segmentation_implemented: true
      compensating_controls: []
  
  # Evidence collection (enhanced for financial audits)
  evidence:
    collect_screenshots: true
    collect_logs: true
    collect_configs: true
    retention_days: 2555  # 7 years (SOX requirement)
    
    # Finance-specific evidence
    financial_controls:
      itgc_evidence: true           # Collect ITGC evidence
      change_tickets: true          # Collect change management evidence
      access_reviews: true          # Collect access review evidence
      encrypt_evidence: true        # Encrypt all collected evidence
    
    # Map evidence to SOX/PCI controls
    control_mapping:
      automatic: true
      sox_mapping: true
      pci_mapping: true
      include_citations: true

# ====
# SCANNING CONFIGURATION (FINANCE-OPTIMIZED)
# ====
scanning:
  # Conservative scanning for financial environments
  stealth_level: 2  # Higher stealth
  max_rate: 75      # Moderate rate
  
  random_delay_min: 60
  random_delay_max: 300
  
  timing_template: "T2"
  max_threads: 8
  
  port_profiles:
    quick: "22,80,443,3389,8080"
    common: "20,21,22,23,25,53,80,110,135,139,143,443,445,993,995,1433,3306,3389,5432,5900,8080,8443"
    finance_specific: "22,80,443,1433,3306,5432,8080,8443,9042,27017"  # DB and web services
    pci_scan: "22,80,443,3389,8080,8443"  # PCI-required ports
    top100: "--top-ports 100"
    top1000: "--top-ports 1000"
    all: "-p-"
  
  default_ports: "finance_specific"
  
  version_detection: true
  os_detection: true  # Required for PCI compliance
  
  # Finance-specific scanning rules
  finance_scanning:
    pci_quarterly_scan: true         # Quarterly PCI ASV scans required
    sox_annual_scan: true            # Annual SOX IT audit
    
    # Trading hours consideration
    avoid_trading_hours: true
    trading_hours:
      start: "09:30"
      end: "16:00"
      timezone: "America/New_York"
    
    # Change freeze periods
    respect_freeze_periods: true
    freeze_periods:
      quarter_end: true              # Avoid quarter-end close
      year_end: true                 # Avoid year-end close

# ====
# SCHEDULING (FINANCIAL COMPLIANCE CYCLES)
# ====
schedule:
  # All scans during non-trading hours
  vulnerability_scan:
    enabled: true
    day: "Saturday"    # Weekend only
    time: "22:00"      # After trading hours
    notify: true
  
  network_scan:
    enabled: true
    day: "Sunday"
    time: "02:00"
    notify: true
  
  compliance_check:
    enabled: true
    day: "Friday"
    time: "18:00"      # After market close
    notify: true
  
  health_check:
    enabled: true
    frequency: "daily"
    time: "06:00"
    notify_on_failure: true
  
  # Finance-specific scheduled tasks
  finance_tasks:
    pci_quarterly_scan:
      enabled: true
      frequency: "quarterly"
      next_due: "2026-03-31"
    
    sox_annual_assessment:
      enabled: true
      frequency: "annual"
      next_due: "2026-12-31"
    
    itgc_testing:
      enabled: true
      frequency: "annual"
      next_due: "2026-12-31"

# ====
# RESULTS & REPORTING (SOX/PCI COMPLIANT)
# ====
results:
  output_dir: "~/.purple-team/results/"
  retention_days: 2555  # 7 years (SOX requirement)
  auto_archive: true
  archive_location: "~/.purple-team/results/archived/"
  
  formats:
    - "json"
    - "html"
    - "csv"
    - "pdf"
  
  branding:
    company_name: "Your Financial Security Consulting Firm"
    logo_path: ""
    footer_text: "Confidential - Financial Information"
  
  executive_reports:
    include_charts: true
    include_recommendations: true
    risk_matrix: true
    
    # Finance-specific reporting
    finance_reporting:
      sox_control_mapping: true
      pci_requirement_mapping: true
      itgc_coverage: true
      gap_analysis: true
      remediation_timeline: true
      cite_regulations: true

# ====
# DASHBOARD
# ====
dashboard:
  host: "127.0.0.1"
  port: 5000
  debug: false
  auth_enabled: true
  username: "admin"
  password_hash: ""
  session_timeout: 20  # 20 minute timeout

# ====
# LOGGING (SOX AUDIT TRAIL)
# ====
logging:
  level: "INFO"
  max_size_mb: 100
  backup_count: 50  # More backup logs for SOX compliance
  
  user_logs: "~/.purple-team/logs/"
  system_logs: "/var/log/purple-team/{username}/"
  
  rotate_daily: true
  
  # SOX audit trail requirements
  sox_audit_trail:
    enabled: true
    log_all_access: true
    log_all_changes: true
    log_privileged_access: true
    tamper_detection: true
    retention_days: 2555  # 7 years

# ====
# EMAIL NOTIFICATIONS
# ====
email:
  enabled: false
  smtp_server: "smtp.gmail.com"
  smtp_port: 587
  use_tls: true
  username: ""
  password: ""
  from_address: ""
  to_addresses: []
  subject_prefix: "[SOX/PCI Audit]"
  include_summary: true
  include_full_report: false
  encrypt_attachments: true

# ====
# EXPLOIT VALIDATION (RESTRICTED FOR FINANCE)
# ====
exploit_validation:
  enabled: false  # Typically disabled in production financial environments
  test_credentials: []

# ====
# INTEGRATION SETTINGS
# ====
integrations:
  thehive:
    enabled: false
    url: "http://localhost:9000"
    api_key: ""
    organization: "finance"
    auto_create_cases: true
  
  wazuh:
    enabled: false
    url: "http://localhost:55000"
    username: ""
    password: ""
    auto_import_alerts: true
  
  suricata:
    enabled: false
    eve_log_path: "/var/log/suricata/eve.json"
    import_alerts: true

# ====
# ADVANCED SETTINGS
# ====
advanced:
  python_stable: "3.11"
  python_latest: "3.12"
  prefer_stable: true
  
  venv_system: "/opt/purple-team/venv"
  venv_user: "~/.purple-team/venv"
  
  auto_update_check: true
  auto_install_updates: false
  check_breaking_changes: true
  
  max_concurrent_scans: 3
  scan_timeout_minutes: 180
  
  auto_backup: true
  backup_location: "/opt/purple-team-backups/"
  backup_retention_days: 90

# ====
# SOX CONTROL MAPPING (IT General Controls)
# ====
sox_itgc_mapping:
  access_controls:
    logical_access:
      - "User provisioning: (manual process - verify with compliance_checker.py)"
      - "User termination: (manual process - verify with compliance_checker.py)"
      - "Periodic access reviews: asset_inventory_tracker.py"
      - "Password policies: compliance_checker.py"
      - "Privileged access: (manual process - verify with compliance_checker.py)"
    
  change_management:
    program_changes:
      - "Change request/approval: (manual process - verify with evidence_manager.py)"
      - "Testing procedures: (manual process)"
      - "Migration controls: (manual process)"
      - "Emergency changes: (manual process)"
  
  computer_operations:
    monitoring:
      - "System monitoring: health_check_monitor.py"
      - "Log monitoring: All scripts log activity"
      - "Incident response: evidence_manager.py + TheHive"
    
    backup_recovery:
      - "Backup procedures: backup_restore.py"
      - "Recovery testing: (manual process - track with compliance_checker.py)"

# ====
# PCI-DSS CONTROL MAPPING
# ====
pci_dss_mapping:
  requirement_1:
    - "Firewall configuration: network_scanner.py (verify firewall rules)"
  
  requirement_2:
    - "Default passwords: vulnerability_scanner.py (check for defaults)"
    - "Secure configurations: compliance_checker.py"
  
  requirement_6:
    - "Vulnerability scanning: vulnerability_scanner.py (quarterly)"
    - "Patch management: patch_status_checker.py"
  
  requirement_10:
    - "Audit logging: All platform scripts"
    - "Log review: health_check_monitor.py"
  
  requirement_11:
    - "Quarterly ASV scans: vulnerability_scanner.py"
    - "Internal scans: network_scanner.py"
    - "Penetration testing: (manual - annual requirement)"

# ====
# END OF FINANCE CONFIGURATION
# ====</code></pre>

                <h3>C.4 Retail Template – <span class="mono">config-retail.yaml</span></h3>
                <pre><code class="language-yaml"># Purple Team GRC Platform Configuration
# Version: 3.0
# Industry: RETAIL
# Compliance: PCI-DSS, CCPA, SOC 2
# Auto-generated: 2026-01-01

client:
  name: "Retail Client Name"
  industry: "retail"
  engagement_type: "pci_assessment"
  engagement_date: "2026-01-01"
  consultant: "Consultant Name"
  contact_email: "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3e4d5b5d4b4c574a477e4c5b4a5f57525d52575b504a105d5153">[email&#160;protected]</a>"
  
  retail:
    entity_type: "merchant"
    pci_scope: true
    pci_level: "Level 1"  # Based on transaction volume
    ecommerce: true
    physical_stores: true
    transaction_volume: 0

network:
  auto_detect: true
  ranges: []
  exclusions: []
  dns_servers: ["8.8.8.8", "1.1.1.1"]
  prefer_wired: true
  scan_all_interfaces: true
  
  retail_network:
    pos_network: false
    ecommerce_platform: true
    payment_gateway_hosted: true

compliance:
  frameworks:
    - "PCI-DSS"
    - "CCPA"
    - "SOC2"
    - "NIST"
    - "ISO27001"
  
  pci_dss:
    version: "4.0"
    requirements:
      req_1_firewall: true
      req_2_defaults: true
      req_3_protect_data: true
      req_4_encrypt_transmission: true
      req_5_malware: true
      req_6_secure_systems: true
      req_7_access_controls: true
      req_8_identify_users: true
      req_9_physical_access: true
      req_10_log_access: true
      req_11_test_security: true
      req_12_security_policy: true
    cardholder_data_environment:
      in_scope: true
      segmentation_implemented: true
  
  evidence:
    collect_screenshots: true
    collect_logs: true
    collect_configs: true
    retention_days: 1095  # 3 years (PCI requirement)
    encrypt_evidence: true

scanning:
  stealth_level: 3
  max_rate: 100
  random_delay_min: 30
  random_delay_max: 300
  timing_template: "T2"
  max_threads: 10
  port_profiles:
    quick: "22,80,443,3389"
    common: "22,80,443,3306,3389,8080,8443"
    retail_specific: "22,80,443,3306,3389,5432,8080,8443,9200"
    pci_scan: "22,80,443,3389,8080,8443"
  default_ports: "retail_specific"
  version_detection: true
  os_detection: true
  
  retail_scanning:
    avoid_peak_hours: true
    peak_hours:
      start: "10:00"
      end: "20:00"
    avoid_black_friday: true
    avoid_cyber_monday: true
    avoid_holiday_season: true

schedule:
  vulnerability_scan:
    enabled: true
    day: "Tuesday"
    time: "03:00"
    notify: true
  network_scan:
    enabled: true
    day: "Thursday"
    time: "03:00"
    notify: true
  compliance_check:
    enabled: true
    day: "Sunday"
    time: "02:00"
    notify: true
  health_check:
    enabled: true
    frequency: "daily"
    time: "06:00"
  
  retail_tasks:
    pci_quarterly_scan:
      enabled: true
      frequency: "quarterly"
      next_due: "2026-03-31"
    seasonal_prep:
      holiday_scan: true
      pre_holiday_date: "2026-11-01"

results:
  output_dir: "~/.purple-team/results/"
  retention_days: 1095
  auto_archive: true
  formats: ["json", "html", "csv", "pdf"]
  branding:
    company_name: "Your Retail Security Consulting Firm"
    footer_text: "Confidential - PCI Protected Information"
  executive_reports:
    include_charts: true
    pci_requirement_mapping: true

dashboard:
  host: "127.0.0.1"
  port: 5000
  debug: false
  auth_enabled: true
  session_timeout: 30

logging:
  level: "INFO"
  max_size_mb: 100
  backup_count: 20
  user_logs: "~/.purple-team/logs/"
  system_logs: "/var/log/purple-team/{username}/"
  rotate_daily: true
  
  pci_audit_trail:
    enabled: true
    log_all_access: true
    retention_days: 1095

email:
  enabled: false
  subject_prefix: "[PCI Audit]"
  encrypt_attachments: true

exploit_validation:
  enabled: false

advanced:
  python_stable: "3.11"
  prefer_stable: true
  auto_update_check: true
  auto_install_updates: false

pci_dss_mapping:
  requirement_6:
    - "Quarterly vulnerability scans: vulnerability_scanner.py"
  requirement_10:
    - "Audit logging: All platform scripts"
  requirement_11:
    - "Quarterly ASV scans: vulnerability_scanner.py"
    - "Internal network scans: network_scanner.py"</code></pre>

                <h3>C.5 Government Template – <span class="mono">config-government.yaml</span></h3>
                <pre><code class="language-yaml"># Purple Team GRC Platform Configuration
# Version: 3.0
# Industry: GOVERNMENT
# Compliance: FedRAMP, FISMA, NIST 800-53, CMMC
# Auto-generated: 2026-01-01

client:
  name: "Government Agency Name"
  industry: "government"
  engagement_type: "fedramp_assessment"
  engagement_date: "2026-01-01"
  consultant: "Consultant Name"
  contact_email: "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a7ced4d4c8e7c6c0c2c9c4de89c0c8d1">[email&#160;protected]</a>"
  
  government:
    entity_type: "federal_agency"  # federal_agency, state_agency, contractor
    fedramp_scope: true
    fedramp_level: "High"  # Low, Moderate, High
    fisma_category: "High"  # Low, Moderate, High
    cmmc_level: 3  # 1, 2, or 3
    cui_in_scope: true  # Controlled Unclassified Information
    classified_systems: false

network:
  auto_detect: true
  ranges: []
  exclusions: []
  dns_servers: ["8.8.8.8", "1.1.1.1"]
  prefer_wired: true
  scan_all_interfaces: true
  
  government_network:
    isolated_network: true
    air_gapped_systems: false
    classified_network: false
    cui_network: true

compliance:
  frameworks:
    - "FedRAMP"
    - "FISMA"
    - "NIST-800-53"  # NIST SP 800-53 Rev 5
    - "NIST-800-171" # For CUI
    - "CMMC"         # Cybersecurity Maturity Model Certification
    - "SOC2"
    - "ISO27001"
  
  fedramp:
    authorization_level: "High"
    baseline: "NIST-800-53-Rev5-High"
    continuous_monitoring: true
    
  nist_800_53:
    revision: "5"
    control_families:
      ac_access_control: true
      au_audit_accountability: true
      at_awareness_training: true
      cm_configuration_management: true
      cp_contingency_planning: true
      ia_identification_authentication: true
      ir_incident_response: true
      ma_maintenance: true
      mp_media_protection: true
      ps_personnel_security: true
      pe_physical_environmental: true
      pl_planning: true
      pm_program_management: true
      ra_risk_assessment: true
      ca_assessment_authorization: true
      sc_system_communications: true
      si_system_information_integrity: true
      sa_system_services_acquisition: true
      sr_supply_chain_risk: true
  
  cmmc:
    level: 3
    domains:
      access_control: true
      asset_management: true
      audit_accountability: true
      awareness_training: true
      configuration_management: true
      identification_authentication: true
      incident_response: true
      maintenance: true
      media_protection: true
      personnel_security: true
      physical_protection: true
      recovery: true
      risk_management: true
      security_assessment: true
      situational_awareness: true
      system_communications: true
      system_information_integrity: true
  
  evidence:
    collect_screenshots: true
    collect_logs: true
    collect_configs: true
    retention_days: 2555  # 7 years (NARA requirement)
    
    government_controls:
      cui_handling: true
      encrypt_evidence: true
      fips_140_2: true  # FIPS 140-2 encryption required
      audit_access: true

scanning:
  stealth_level: 2
  max_rate: 50
  random_delay_min: 60
  random_delay_max: 600
  timing_template: "T1"
  max_threads: 5
  port_profiles:
    quick: "22,80,443"
    common: "22,80,135,139,443,445,3389,8080,8443"
    government_specific: "22,80,443,389,636,3389,5432,8080,8443"
  default_ports: "government_specific"
  version_detection: true
  os_detection: true
  
  government_scanning:
    require_ato: true  # Authority to Operate required
    continuous_monitoring: true
    monthly_scans: true
    fips_mode: true  # Use FIPS 140-2 validated tools

schedule:
  vulnerability_scan:
    enabled: true
    day: "Saturday"
    time: "22:00"
    notify: true
  network_scan:
    enabled: true
    day: "Sunday"
    time: "02:00"
    notify: true
  compliance_check:
    enabled: true
    day: "Friday"
    time: "18:00"
    notify: true
  health_check:
    enabled: true
    frequency: "daily"
    time: "06:00"
  
  government_tasks:
    monthly_fedramp_scan:
      enabled: true
      frequency: "monthly"
      day: 1  # First day of month
    
    annual_assessment:
      enabled: true
      frequency: "annual"
      next_due: "2027-01-01"
    
    continuous_monitoring:
      enabled: true
      frequency: "daily"

results:
  output_dir: "~/.purple-team/results/"
  retention_days: 2555  # 7 years
  auto_archive: true
  formats: ["json", "html", "csv", "pdf"]
  branding:
    company_name: "Your Government Security Consulting Firm"
    footer_text: "For Official Use Only - CUI"
  executive_reports:
    include_charts: true
    nist_800_53_mapping: true
    fedramp_mapping: true
    cmmc_mapping: true
    poam_generation: true  # Plan of Action & Milestones

dashboard:
  host: "127.0.0.1"
  port: 5000
  debug: false
  auth_enabled: true
  session_timeout: 15

logging:
  level: "INFO"
  max_size_mb: 100
  backup_count: 100
  user_logs: "~/.purple-team/logs/"
  system_logs: "/var/log/purple-team/{username}/"
  rotate_daily: true
  
  government_audit_trail:
    enabled: true
    log_all_access: true
    log_all_changes: true
    tamper_detection: true
    retention_days: 2555
    fips_140_2_encryption: true

email:
  enabled: false
  subject_prefix: "[FedRAMP Assessment]"
  encrypt_attachments: true
  fips_encryption: true

exploit_validation:
  enabled: false

advanced:
  python_stable: "3.11"
  prefer_stable: true
  auto_update_check: true
  auto_install_updates: false
  
  government_advanced:
    fips_mode: true
    cui_encryption:
      enabled: true
      algorithm: "AES-256"
      fips_140_2_validated: true
    access_controls:
      require_piv: false  # PIV/CAC card authentication
      require_2fa: true
      session_timeout_minutes: 15

nist_800_53_control_mapping:
  ac_access_control:
    - "AC-2: Account management: (manual - verify with compliance_checker.py)"
    - "AC-3: Access enforcement: dashboard authentication"
    - "AC-17: Remote access: (manual - verify SSH configurations)"
  
  au_audit_accountability:
    - "AU-2: Audit events: All platform scripts log activity"
    - "AU-3: Content of audit records: Detailed logging configured"
    - "AU-6: Audit review: health_check_monitor.py"
    - "AU-9: Protection of audit info: Log tamper detection enabled"
  
  cm_configuration_management:
    - "CM-2: Baseline configuration: config_change_detector.py"
    - "CM-3: Configuration change control: (manual - track changes)"
    - "CM-6: Configuration settings: compliance_checker.py"
  
  ia_identification_authentication:
    - "IA-2: Identification and authentication: dashboard authentication"
    - "IA-5: Authenticator management: (manual - password policies)"
  
  ra_risk_assessment:
    - "RA-3: Risk assessment: risk_scorer.py"
    - "RA-5: Vulnerability scanning: vulnerability_scanner.py"
  
  sc_system_communications:
    - "SC-7: Boundary protection: network_scanner.py (firewall verification)"
    - "SC-8: Transmission confidentiality: (verify encryption)"
  
  si_system_information_integrity:
    - "SI-2: Flaw remediation: patch_status_checker.py"
    - "SI-4: Information system monitoring: health_check_monitor.py"

cmmc_practice_mapping:
  level_1:
    - "Basic cyber hygiene: compliance_checker.py"
  level_2:
    - "Intermediate cyber hygiene: Full platform capabilities"
  level_3:
    - "Good cyber hygiene: Advanced monitoring and response"</code></pre>
            </section>

            <!-- APPENDIX D – TROUBLESHOOTING DECISION TREES -->
            <section id="appendix-d-decision-trees">
                <h2>Appendix D – Troubleshooting Decision Trees</h2>

                <h3>D.1 Permission Problems</h3>
                <pre class="decision-tree"><code class="language-text">Start
  |
  v
"Permission denied" or "Operation not permitted"?
  |
  +--> Yes
        |
        v
    Are you using sudo only for installation tasks?
        |
        +--> No  --> Use normal user for daily work; rerun without sudo.
        |
        +--> Yes
              |
              v
          Does the error mention ~/.purple-team ?
              |
              +--> Yes
              |      |
              |      v
              |   Check ownership:
              |     ls -ld ~/.purple-team
              |     ls -l ~/.purple-team/config.yaml
              |
              |   Owned by root?
              |      |
              |      +--> Yes --> sudo chown -R "$USER:$USER" ~/.purple-team
              |      |
              |      +--> No  --> See logs under ~/.purple-team/logs for exact script
              |
              +--> No
                    |
                    v
                 Does the error mention /opt/purple-team ?
                    |
                    +--> Yes --> You should not be writing there as user.
                    |           Use purple-team-launcher or scripts under ~/.purple-team.
                    |
                    +--> No  --> Check full error text in log; may be disk full or other OS issue.</code></pre>

                <h3>D.2 “No networks found” or Empty Scans</h3>
                <pre class="decision-tree"><code class="language-text">Start
  |
  v
Scan completes but finds 0 hosts?
  |
  +--> Yes
        |
        v
    Are you connected to the client network (Ethernet/Wi-Fi)?
        |
        +--> No  --> Connect to network and try again.
        |
        +--> Yes
              |
              v
        Run: python3 /opt/purple-team/utils/network-detector.py
              |
              v
        Did it detect RFC1918 ranges?
              |
              +--> No
              |      |
              |      v
              |   Use ip addr show and add ranges manually to config.yaml
              |
              +--> Yes
                    |
                    v
            Open ~/.purple-team/config.yaml
              |
              v
            Are ranges listed under network.ranges?
              |
              +--> No  --> Rerun network-detector.py with --force
              |
              +--> Yes --> Ensure target systems are in those ranges and not in exclusions.</code></pre>

                <h3>D.3 Python “ModuleNotFoundError”</h3>
                <pre class="decision-tree"><code class="language-text">Start
  |
  v
Python error: "ModuleNotFoundError" ?
  |
  +--> Yes
        |
        v
    Are you running scripts with purple-team-launcher?
        |
        +--> No  --> Use purple-team-launcher or source the venv:
        |            source /opt/purple-team/venv/bin/activate
        |
        +--> Yes
              |
              v
        Run pre-flight checker:
          /opt/purple-team/utils/pre-flight-checker.py
              |
              v
        Does it report missing Python packages?
              |
              +--> Yes --> Re-run master_setup.sh to reinstall Python deps.
              |
              +--> No  --> Check that path_helper.py exists and is readable in utils/.</code></pre>
            </section>

            <!-- APPENDIX E – NETWORK DIAGRAMS -->
            <section id="appendix-e-network-diagrams">
                <h2>Appendix E – Network Diagram Templates</h2>

                <h3>E.1 Single Network (Simple Office)</h3>
                <pre><code class="language-text">           Internet
              |
        ┌────┴────┐
        │  Firewall │  (10.50.0.1)
        └────┬────┘
              |
      ┌────┼────┐
      │                    │
┌────┴────┐                    ┌────┴────┐
│ Purple    │                    │   Servers   │
│ Team      │                    │ (DC, File)  │
│ Laptop    │                    │ 10.50.0.10  │
│10.50.0.143│                    │ 10.50.0.20  │
└────┘                    └────┘

Scan scope:
  - network.ranges: ["10.50.0.0/24"]
  - network.exclusions: ["10.50.0.1"]</code></pre>

                <h3>E.2 Dual Network (Corporate + Guest Wi-Fi)</h3>
                <pre><code class="language-text">                 ┌────┐
                 │   Purple Team      │
                 │       Laptop       │
                 │                    │
                 │ eth0: 10.50.25.143 │  (corporate LAN)
                 │ wlan0: 192.168.1.45│  (guest Wi-Fi)
                 └────┬────┘
                    │
        ┌────┼────┐
        │                    │
┌────┴────┐                    ┌────┴────┐
│ Corporate LAN   │                    │ Guest Wi-Fi │
│ 10.50.25.0/24   │                    │192.168.1.0/24│
└────┘                    └────┘

Best practice:
  - Scan one network at a time.
  - Keep guest Wi-Fi scans minimal; main focus is corporate LAN.</code></pre>
            </section>

            <!-- APPENDIX F – COMPLIANCE MAPPING -->
            <section id="appendix-f-compliance">
                <h2>Appendix F – Compliance Framework Mapping</h2>

                <h3>F.1 SOC 2 Example Mapping</h3>
                <table>
                    <tr><th>Control</th><th>Description</th><th>Primary Evidence</th><th>Scripts</th></tr>
                    <tr>
                        <td>CC6.1</td>
                        <td>Logical and physical access controls</td>
                        <td>Access configuration, network exposure</td>
                        <td><span class="mono">network_scanner.py</span>, <span class="mono">compliance_checker.py</span></td>
                    </tr>
                    <tr>
                        <td>CC6.6</td>
                        <td>Vulnerability management</td>
                        <td>Vulnerability reports, patch status</td>
                        <td><span class="mono">vulnerability_scanner.py</span>, <span class="mono">patch_status_checker.py</span></td>
                    </tr>
                    <tr>
                        <td>CC7.2</td>
                        <td>System monitoring</td>
                        <td>Monitoring and health check logs</td>
                        <td><span class="mono">health_check_monitor.py</span>, <span class="mono">service_availability_monitor.py</span></td>
                    </tr>
                </table>

                <h3>F.2 HIPAA Technical Safeguards (Healthcare Template)</h3>
                <table>
                    <tr><th>HIPAA Citation</th><th>Safeguard</th><th>Platform Evidence</th></tr>
                    <tr>
                        <td>§164.312(a)(1)</td>
                        <td>Access control</td>
                        <td>Dashboard authentication, config of sessions; reports from <span class="mono">compliance_checker.py</span>.</td>
                    </tr>
                    <tr>
                        <td>§164.312(b)</td>
                        <td>Audit controls</td>
                        <td>Dual logs from all scanners; evidence DB via <span class="mono">evidence_manager.py</span>.</td>
                    </tr>
                    <tr>
                        <td>§164.312(e)(1)</td>
                        <td>Transmission security</td>
                        <td>TLS/SSL checks via <span class="mono">network_scanner.py</span>, <span class="mono">exploit_validator.py</span>.</td>
                    </tr>
                </table>

                <h3>F.3 PCI-DSS Highlights (Finance/Retail Templates)</h3>
                <table>
                    <tr><th>PCI Requirement</th><th>Focus Area</th><th>Platform Evidence</th></tr>
                    <tr>
                        <td>Req. 1</td>
                        <td>Network security controls</td>
                        <td>Firewall and segmentation verification from network scans.</td>
                    </tr>
                    <tr>
                        <td>Req. 6</td>
                        <td>Vulnerability management</td>
                        <td>Quarterly results from <span class="mono">vulnerability_scanner.py</span> and <span class="mono">patch_status_checker.py</span>.</td>
                    </tr>
                    <tr>
                        <td>Req. 10</td>
                        <td>Logging and monitoring</td>
                        <td>System and user logs, health monitoring reports.</td>
                    </tr>
                    <tr>
                        <td>Req. 11</td>
                        <td>Regular testing</td>
                        <td>ASV‑like scans and internal network assessments scheduled via <span class="mono">scheduler.py</span>.</td>
                    </tr>
                </table>
            </section>

            <!-- APPENDIX G – COMMAND REFERENCE -->
            <section id="appendix-g-commands">
                <h2>Appendix G – Complete Command Reference</h2>

                <h3>G.1 Core Installation &amp; System Commands</h3>
                <pre><code class="language-bash"># Show distribution information
cat /etc/os-release

# Verify Kali Purple metapackage
dpkg -l | grep kali-linux-purple

# Update package lists and upgrade
sudo apt update
sudo apt upgrade -y

# Check disk space (root filesystem)
df -h /

# Show current user
whoami</code></pre>

                <h3>G.2 Master Setup &amp; Validation</h3>
                <pre><code class="language-bash"># Make setup script executable
chmod +x master_setup.sh

# Run master setup with sudo
sudo ./master_setup.sh

# Verify installation directories
ls -ld /opt/purple-team
ls -ld ~/.purple-team

# Verify main config ownership
ls -l ~/.purple-team/config.yaml

# Fix ownership if needed
sudo chown "$USER:$USER" ~/.purple-team/config.yaml

# Run pre-flight checks after installation
sudo /opt/purple-team/utils/pre-flight-checker.py</code></pre>

                <h3>G.3 Launchers &amp; Sync</h3>
                <pre><code class="language-bash"># Terminal launcher (interactive menu)
purple-team-launcher

# Desktop GUI launcher
purple-team-gui

# Manual sync between /opt and ~/.purple-team
purple-team-sync

# Check location of launchers
which purple-team-launcher
which purple-team-gui
which purple-team-sync</code></pre>

                <h3>G.4 Scanning &amp; Reporting</h3>
                <pre><code class="language-bash"># Network discovery (uses config.yaml)
python3 /opt/purple-team/scanners/network_scanner.py

# Vulnerability scan
python3 /opt/purple-team/scanners/vulnerability_scanner.py

# Compliance check
python3 /opt/purple-team/scanners/compliance_checker.py

# Integrated GRC scan
python3 /opt/purple-team/scanners/integrated_grc_scanner.py

# Quick scan (fast spot-check)
python3 /opt/purple-team/scanners/quick_scan.py

# Executive one-page report
python3 /opt/purple-team/utilities/executive_report_generator.py

# Evidence package creation
python3 /opt/purple-team/utilities/evidence_manager.py --create-package</code></pre>

                <h3>G.5 Configuration &amp; Logs</h3>
                <pre><code class="language-bash"># Edit main configuration
nano ~/.purple-team/config.yaml

# View logs
ls ~/.purple-team/logs
tail -50 ~/.purple-team/logs/network_scanner.log

# Show latest results
ls ~/.purple-team/results
ls ~/.purple-team/results/network-scans</code></pre>
            </section>

            <!-- APPENDIX H – RECOVERY PROCEDURES -->
            <section id="appendix-h-recovery">
                <h2>Appendix H – Recovery Procedures</h2>

                <h3>H.1 Repairing a Damaged User Installation</h3>
                <pre><code class="language-bash"># Backup current user directory (if it exists)
cp -r ~/.purple-team ~/purple-team-backup-$(date +%Y%m%d) 2>/dev/null || echo "No existing user dir"

# Recreate user directory from system templates
mkdir -p ~/.purple-team
cp /opt/purple-team/config/config-template.yaml ~/.purple-team/config.yaml
chown -R "$USER:$USER" ~/.purple-team</code></pre>

                <h3>H.2 Re-installing the System Installation</h3>
                <pre><code class="language-bash"># Backup /opt/purple-team if present
sudo tar -czf /tmp/purple-team-backup-$(date +%Y%m%d).tar.gz /opt/purple-team 2>/dev/null || echo "No /opt backup created"

# Remove damaged installation
sudo rm -rf /opt/purple-team

# Re-run master setup from package directory
cd ~/Downloads/purple-team-package-v3.0
sudo ./master_setup.sh</code></pre>

                <h3>H.3 Restoring from Backup</h3>
                <pre><code class="language-bash"># Use backup_restore utility
python3 /opt/purple-team/utilities/backup_restore.py create   # create backup
python3 /opt/purple-team/utilities/backup_restore.py restore --latest   # restore most recent</code></pre>

                <h3>H.4 Last-Resort Full Rebuild</h3>
                <pre><code class="language-bash"># 1. Save current user data (if possible)
cp -r ~/.purple-team ~/purple-team-salvage-$(date +%Y%m%d) 2>/dev/null || true

# 2. Remove user and system installations
rm -rf ~/.purple-team
sudo rm -rf /opt/purple-team

# 3. Re-run master setup from original package
cd ~/Downloads/purple-team-package-v3.0
sudo ./master_setup.sh

# 4. Reintroduce salvaged results/evidence manually if needed</code></pre>
            </section>

        </div>
        <!-- END: Full original guide content -->
    </main>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
    // ====
    // THEME TOGGLE LOGIC
    // ====

        </script>
</body>
</html>